{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button,IconButton,Paper,Popover,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Typography}from'@material-ui/core';import{ButtonOutlined}from'litmus-ui';import React,{useState}from'react';import{useTranslation}from'react-i18next';import{useSelector}from'react-redux';import YAML from'yaml';import useActions from'../../../../redux/actions';import*as WorkflowActions from'../../../../redux/actions/workflow';import AddProbe from'../AddProbe';import useStyles from'./styles';var SteadyState=function SteadyState(_ref){var engineIndex=_ref.engineIndex,gotoStep=_ref.gotoStep,closeStepper=_ref.closeStepper;var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var workflow=useActions(WorkflowActions);var manifest=useSelector(function(state){return state.workflowManifest;});var chaosEngine=YAML.parse(manifest.engineYAML);var _useState=useState(chaosEngine.spec.experiments[0].spec.probe&&chaosEngine.spec.experiments[0].spec.probe.length?chaosEngine.spec.experiments[0].spec.probe:[]),_useState2=_slicedToArray(_useState,2),probesData=_useState2[0],setProbesData=_useState2[1];// State varible to handle the Probe Modal\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),addProbe=_useState4[0],setAddProbe=_useState4[1];var handleClose=function handleClose(){setAddProbe(false);};// handleManiYAMLChange allows to update the main manifest\n// with the changes in individual Chaos Engines\nvar handleMainYAMLChange=function handleMainYAMLChange(){var mainManifest=YAML.parse(manifest.manifest);mainManifest.spec.templates[engineIndex].inputs.artifacts[0].raw.data=YAML.stringify(chaosEngine);workflow.setWorkflowManifest({manifest:YAML.stringify(mainManifest),engineYAML:YAML.stringify(chaosEngine)});};// State variable to store Probe Data\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),probeDetails=_useState6[0],setProbeDetails=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),probeProperties=_useState8[0],setProbeProperties=_useState8[1];// State variable to handle the Probe Details Popover\nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),popAnchorEl=_React$useState2[0],setPopAnchorEl=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),propertyAnchorEl=_React$useState4[0],setPropertyPopAnchorEl=_React$useState4[1];var isOpen=Boolean(popAnchorEl);var isPropertyOpen=Boolean(propertyAnchorEl);var id=isOpen?'simple-popover':undefined;var propertyid=isPropertyOpen?'simple-popover':undefined;// Event handler for Details and Properties PopOvers\nvar handlePopOverClick=function handlePopOverClick(event){setPopAnchorEl(event.currentTarget);};var handlePropertyPopOverClick=function handlePropertyPopOverClick(event){setPropertyPopAnchorEl(event.currentTarget);};// Funtion to handle delete probe operation\nvar deleteProbe=function deleteProbe(index){probesData.splice(index,1);chaosEngine.spec.experiments[0].spec.probe=probesData;setProbesData(probesData);handleMainYAMLChange();};// Function to handle add probes operation\nvar handleAddProbe=function handleAddProbe(probes){setProbesData(probes);setAddProbe(false);};var handleStepperClose=function handleStepperClose(){chaosEngine.spec.experiments[0].spec.probe=probesData;handleMainYAMLChange();return closeStepper();};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TableContainer,{className:classes.table,component:Paper},/*#__PURE__*/React.createElement(Table,{\"aria-label\":\"simple table\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,null,t('createWorkflow.tuneWorkflow.steadyState.name')),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},t('createWorkflow.tuneWorkflow.steadyState.type')),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},t('createWorkflow.tuneWorkflow.steadyState.mode')),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},t('createWorkflow.tuneWorkflow.steadyState.details')),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},t('createWorkflow.tuneWorkflow.steadyState.properties')),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"}))),/*#__PURE__*/React.createElement(TableBody,null,(probesData===null||probesData===void 0?void 0:probesData.length)?probesData.map(function(probe,index){return/*#__PURE__*/React.createElement(TableRow,{key:probe.name},/*#__PURE__*/React.createElement(TableCell,{component:\"th\",scope:\"row\"},probe.name),/*#__PURE__*/React.createElement(TableCell,{align:\"left\",style:{cursor:'pointer'}},probe.type),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},probe.mode),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:function onClick(event){setProbeDetails(probe[\"\".concat(probe.type,\"/inputs\")]);handlePopOverClick(event);},className:classes.btn1},/*#__PURE__*/React.createElement(Typography,null,t('createWorkflow.tuneWorkflow.steadyState.showDetails')))),/*#__PURE__*/React.createElement(Popover,{id:id,open:isOpen,anchorEl:popAnchorEl,onClose:function onClose(){return setPopAnchorEl(null);},anchorOrigin:{vertical:'bottom',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'center'},className:classes.probePopOver},/*#__PURE__*/React.createElement(\"div\",{className:classes.popOverDiv},/*#__PURE__*/React.createElement(Typography,{className:classes.probeText},/*#__PURE__*/React.createElement(\"pre\",null,YAML.stringify(probeDetails))))),/*#__PURE__*/React.createElement(TableCell,{align:\"left\"},/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:function onClick(event){setProbeProperties(probe.runProperties);handlePropertyPopOverClick(event);},className:classes.btn1},/*#__PURE__*/React.createElement(Typography,null,t('createWorkflow.tuneWorkflow.steadyState.showProp')))),/*#__PURE__*/React.createElement(Popover,{id:propertyid,open:isPropertyOpen,anchorEl:propertyAnchorEl,onClose:function onClose(){return setPropertyPopAnchorEl(null);},anchorOrigin:{vertical:'bottom',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'center'},className:classes.probePopOver},/*#__PURE__*/React.createElement(\"div\",{className:classes.popOverDiv},/*#__PURE__*/React.createElement(Typography,{className:classes.probeText},/*#__PURE__*/React.createElement(\"pre\",null,YAML.stringify(probeProperties))))),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(IconButton,{onClick:function onClick(){deleteProbe(index);}},/*#__PURE__*/React.createElement(\"img\",{src:\"/icons/bin-red-delete.svg\",alt:\"delete\",className:classes.deleteIcon}))));}):/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{colSpan:5},/*#__PURE__*/React.createElement(Typography,{align:\"center\"},t('createWorkflow.tuneWorkflow.steadyState.addProbe'))))))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:function onClick(){setAddProbe(true);},className:classes.btn1},/*#__PURE__*/React.createElement(Typography,null,t('createWorkflow.tuneWorkflow.steadyState.addNewProbe'))),/*#__PURE__*/React.createElement(AddProbe,{probesValue:probesData,addProbe:function addProbe(probes){return handleAddProbe(probes);},handleClose:handleClose,open:addProbe}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return gotoStep(1);},className:classes.button},t('createWorkflow.tuneWorkflow.steadyState.back')),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:function onClick(){return handleStepperClose();},className:classes.button},t('createWorkflow.tuneWorkflow.steadyState.finish'))));};export default SteadyState;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/CreateWorkflow/TuneWorkflow/TuneWorkflowSteps/SteadyState.tsx"],"names":["Button","IconButton","Paper","Popover","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Typography","ButtonOutlined","React","useState","useTranslation","useSelector","YAML","useActions","WorkflowActions","AddProbe","useStyles","SteadyState","engineIndex","gotoStep","closeStepper","classes","t","workflow","manifest","state","workflowManifest","chaosEngine","parse","engineYAML","spec","experiments","probe","length","probesData","setProbesData","addProbe","setAddProbe","handleClose","handleMainYAMLChange","mainManifest","templates","inputs","artifacts","raw","data","stringify","setWorkflowManifest","probeDetails","setProbeDetails","probeProperties","setProbeProperties","popAnchorEl","setPopAnchorEl","propertyAnchorEl","setPropertyPopAnchorEl","isOpen","Boolean","isPropertyOpen","id","undefined","propertyid","handlePopOverClick","event","currentTarget","handlePropertyPopOverClick","deleteProbe","index","splice","handleAddProbe","probes","handleStepperClose","table","map","name","cursor","type","mode","btn1","vertical","horizontal","probePopOver","popOverDiv","probeText","runProperties","deleteIcon","button"],"mappings":"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","sourcesContent":["import {\n  Button,\n  IconButton,\n  Paper,\n  Popover,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Typography,\n} from '@material-ui/core';\nimport { ButtonOutlined } from 'litmus-ui';\nimport React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useSelector } from 'react-redux';\nimport YAML from 'yaml';\nimport { WorkflowManifest } from '../../../../models/redux/workflow';\nimport useActions from '../../../../redux/actions';\nimport * as WorkflowActions from '../../../../redux/actions/workflow';\nimport { RootState } from '../../../../redux/reducers';\nimport AddProbe from '../AddProbe';\nimport useStyles from './styles';\n\ninterface SteadyStateProps {\n  engineIndex: number;\n  gotoStep: (page: number) => void;\n  closeStepper: () => void;\n}\n\nconst SteadyState: React.FC<SteadyStateProps> = ({\n  engineIndex,\n  gotoStep,\n  closeStepper,\n}) => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const workflow = useActions(WorkflowActions);\n\n  const manifest: WorkflowManifest = useSelector(\n    (state: RootState) => state.workflowManifest\n  );\n  const chaosEngine = YAML.parse(manifest.engineYAML);\n  const [probesData, setProbesData] = useState(\n    chaosEngine.spec.experiments[0].spec.probe &&\n      chaosEngine.spec.experiments[0].spec.probe.length\n      ? chaosEngine.spec.experiments[0].spec.probe\n      : []\n  );\n\n  // State varible to handle the Probe Modal\n  const [addProbe, setAddProbe] = useState<boolean>(false);\n  const handleClose = () => {\n    setAddProbe(false);\n  };\n\n  // handleManiYAMLChange allows to update the main manifest\n  // with the changes in individual Chaos Engines\n  const handleMainYAMLChange = () => {\n    const mainManifest = YAML.parse(manifest.manifest);\n    mainManifest.spec.templates[engineIndex].inputs.artifacts[0].raw.data =\n      YAML.stringify(chaosEngine);\n    workflow.setWorkflowManifest({\n      manifest: YAML.stringify(mainManifest),\n      engineYAML: YAML.stringify(chaosEngine),\n    });\n  };\n\n  // State variable to store Probe Data\n  const [probeDetails, setProbeDetails] = useState<object>();\n  const [probeProperties, setProbeProperties] = useState({});\n\n  // State variable to handle the Probe Details Popover\n  const [popAnchorEl, setPopAnchorEl] = React.useState<null | HTMLElement>(\n    null\n  );\n  const [propertyAnchorEl, setPropertyPopAnchorEl] =\n    React.useState<null | HTMLElement>(null);\n  const isOpen = Boolean(popAnchorEl);\n  const isPropertyOpen = Boolean(propertyAnchorEl);\n  const id = isOpen ? 'simple-popover' : undefined;\n  const propertyid = isPropertyOpen ? 'simple-popover' : undefined;\n\n  // Event handler for Details and Properties PopOvers\n  const handlePopOverClick = (event: React.MouseEvent<HTMLElement>) => {\n    setPopAnchorEl(event.currentTarget);\n  };\n  const handlePropertyPopOverClick = (event: React.MouseEvent<HTMLElement>) => {\n    setPropertyPopAnchorEl(event.currentTarget);\n  };\n\n  // Funtion to handle delete probe operation\n  const deleteProbe = (index: number) => {\n    probesData.splice(index, 1);\n    chaosEngine.spec.experiments[0].spec.probe = probesData;\n    setProbesData(probesData);\n    handleMainYAMLChange();\n  };\n  // Function to handle add probes operation\n  const handleAddProbe = (probes: any) => {\n    setProbesData(probes);\n    setAddProbe(false);\n  };\n\n  const handleStepperClose = () => {\n    chaosEngine.spec.experiments[0].spec.probe = probesData;\n    handleMainYAMLChange();\n    return closeStepper();\n  };\n\n  return (\n    <div>\n      <TableContainer className={classes.table} component={Paper}>\n        <Table aria-label=\"simple table\">\n          <TableHead>\n            <TableRow>\n              <TableCell>\n                {t('createWorkflow.tuneWorkflow.steadyState.name')}\n              </TableCell>\n              <TableCell align=\"left\">\n                {t('createWorkflow.tuneWorkflow.steadyState.type')}\n              </TableCell>\n              <TableCell align=\"left\">\n                {t('createWorkflow.tuneWorkflow.steadyState.mode')}\n              </TableCell>\n              <TableCell align=\"left\">\n                {t('createWorkflow.tuneWorkflow.steadyState.details')}\n              </TableCell>\n              <TableCell align=\"left\">\n                {t('createWorkflow.tuneWorkflow.steadyState.properties')}\n              </TableCell>\n              <TableCell align=\"left\" />\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {probesData?.length ? (\n              probesData.map((probe: any, index: number) => (\n                <TableRow key={probe.name}>\n                  <TableCell component=\"th\" scope=\"row\">\n                    {probe.name}\n                  </TableCell>\n                  <TableCell align=\"left\" style={{ cursor: 'pointer' }}>\n                    {probe.type}\n                  </TableCell>\n                  <TableCell align=\"left\">{probe.mode}</TableCell>\n                  <TableCell align=\"left\">\n                    <ButtonOutlined\n                      onClick={(event) => {\n                        setProbeDetails(probe[`${probe.type}/inputs`]);\n                        handlePopOverClick(event);\n                      }}\n                      className={classes.btn1}\n                    >\n                      <Typography>\n                        {t(\n                          'createWorkflow.tuneWorkflow.steadyState.showDetails'\n                        )}\n                      </Typography>\n                    </ButtonOutlined>\n                  </TableCell>\n\n                  {/* Probe Details PopOver */}\n                  <Popover\n                    id={id}\n                    open={isOpen}\n                    anchorEl={popAnchorEl}\n                    onClose={() => setPopAnchorEl(null)}\n                    anchorOrigin={{\n                      vertical: 'bottom',\n                      horizontal: 'center',\n                    }}\n                    transformOrigin={{\n                      vertical: 'top',\n                      horizontal: 'center',\n                    }}\n                    className={classes.probePopOver}\n                  >\n                    <div className={classes.popOverDiv}>\n                      <Typography className={classes.probeText}>\n                        <pre>{YAML.stringify(probeDetails)}</pre>\n                      </Typography>\n                    </div>\n                  </Popover>\n                  <TableCell align=\"left\">\n                    <ButtonOutlined\n                      onClick={(event) => {\n                        setProbeProperties(probe.runProperties);\n                        handlePropertyPopOverClick(event);\n                      }}\n                      className={classes.btn1}\n                    >\n                      <Typography>\n                        {t('createWorkflow.tuneWorkflow.steadyState.showProp')}\n                      </Typography>\n                    </ButtonOutlined>\n                  </TableCell>\n\n                  {/* Probe Properties PopOver */}\n                  <Popover\n                    id={propertyid}\n                    open={isPropertyOpen}\n                    anchorEl={propertyAnchorEl}\n                    onClose={() => setPropertyPopAnchorEl(null)}\n                    anchorOrigin={{\n                      vertical: 'bottom',\n                      horizontal: 'center',\n                    }}\n                    transformOrigin={{\n                      vertical: 'top',\n                      horizontal: 'center',\n                    }}\n                    className={classes.probePopOver}\n                  >\n                    <div className={classes.popOverDiv}>\n                      <Typography className={classes.probeText}>\n                        <pre>{YAML.stringify(probeProperties)}</pre>\n                      </Typography>\n                    </div>\n                  </Popover>\n                  <TableCell>\n                    <IconButton\n                      onClick={() => {\n                        deleteProbe(index);\n                      }}\n                    >\n                      <img\n                        src=\"/icons/bin-red-delete.svg\"\n                        alt=\"delete\"\n                        className={classes.deleteIcon}\n                      />\n                    </IconButton>\n                  </TableCell>\n                </TableRow>\n              ))\n            ) : (\n              <TableRow>\n                <TableCell colSpan={5}>\n                  <Typography align=\"center\">\n                    {t('createWorkflow.tuneWorkflow.steadyState.addProbe')}\n                  </Typography>\n                </TableCell>\n              </TableRow>\n            )}\n          </TableBody>\n        </Table>\n      </TableContainer>\n      <br />\n      <ButtonOutlined\n        onClick={() => {\n          setAddProbe(true);\n        }}\n        className={classes.btn1}\n      >\n        <Typography>\n          {t('createWorkflow.tuneWorkflow.steadyState.addNewProbe')}\n        </Typography>\n      </ButtonOutlined>\n      <AddProbe\n        probesValue={probesData}\n        addProbe={(probes: any) => handleAddProbe(probes)}\n        handleClose={handleClose}\n        open={addProbe}\n      />\n      <div>\n        <Button onClick={() => gotoStep(1)} className={classes.button}>\n          {t('createWorkflow.tuneWorkflow.steadyState.back')}\n        </Button>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={() => handleStepperClose()}\n          className={classes.button}\n        >\n          {t('createWorkflow.tuneWorkflow.steadyState.finish')}\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default SteadyState;\n"]},"metadata":{},"sourceType":"module"}