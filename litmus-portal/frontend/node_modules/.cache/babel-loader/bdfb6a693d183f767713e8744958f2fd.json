{"ast":null,"code":"import _objectSpread from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{createStyles,FormControl,IconButton,InputAdornment,InputLabel,Menu,MenuItem,Paper,Select,Table,TableBody,TableCell,TableContainer,TableHead,TablePagination,TableRow,TextField,Toolbar,Typography,withStyles}from'@material-ui/core';import MoreVertIcon from'@material-ui/icons/MoreVert';import SearchIcon from'@material-ui/icons/Search';import{ButtonFilled,LightPills}from'litmus-ui';import moment from'moment';import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import config from'../../../../config';import{UserRole}from'../../../../models/graphql/user';import{getToken}from'../../../../utils/auth';import CreateUser from'../CreateUser';import EditUser from'../EditUser';import useStyles from'./styles';// StyledTableCell used to create custom table cell\nvar StyledTableCell=withStyles(function(theme){return createStyles({head:{backgroundColor:theme.palette.cards.background,color:theme.palette.text.primary},body:{fontSize:'0.875rem'}});})(TableCell);// UserManagement displays users table\nvar UserManagement=function UserManagement(){var _rows$filter,_currRow$email,_currRow$name,_currRow$username,_filteredData$length;var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),showDiv=_React$useState2[0],setShowDiv=_React$useState2[1];// for response data\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),rows=_useState2[0],setRows=_useState2[1];// States for filters\nvar _useState3=useState({search:'',status:'all'}),_useState4=_slicedToArray(_useState3,2),filters=_useState4[0],setFilters=_useState4[1];// State for pagination\nvar _useState5=useState({pageNo:0,rowsPerPage:5}),_useState6=_slicedToArray(_useState5,2),paginationData=_useState6[0],setPaginationData=_useState6[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),editDiv=_React$useState4[0],setEditDiv=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),anchorEl=_React$useState6[0],setAnchorEl=_React$useState6[1];useEffect(function(){fetch(\"\".concat(config.auth.url,\"/users\"),{headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(getToken())}}).then(function(response){return response.json();}).then(function(res){setRows(res);}).catch(function(err){console.error(err);});},[showDiv]);var filteredData=rows===null||rows===void 0?void 0:(_rows$filter=rows.filter(function(dataRow){return dataRow.username!==UserRole.admin;}))===null||_rows$filter===void 0?void 0:_rows$filter.filter(function(dataRow){return dataRow.username.toLowerCase().includes(filters.search.toLowerCase());}).filter(function(datarow){if(filters.status==='all')return true;if(filters.status==='signedin')return datarow.logged_in===true;return datarow.logged_in===false;});var handleClose=function handleClose(){setAnchorEl(null);};var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),currRow=_React$useState8[0],setCurrRow=_React$useState8[1];var formatDate=function formatDate(date){var day=moment(date).format('Do MMM, YYYY LT');return day;};return/*#__PURE__*/React.createElement(\"div\",null,showDiv?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(CreateUser,{handleDiv:function handleDiv(){return setShowDiv(false);}})):/*#__PURE__*/React.createElement(\"div\",null,editDiv?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(EditUser,{handleDiv:function handleDiv(){return setEditDiv(false);},email:(_currRow$email=currRow===null||currRow===void 0?void 0:currRow.email)!==null&&_currRow$email!==void 0?_currRow$email:'',fullName:(_currRow$name=currRow===null||currRow===void 0?void 0:currRow.name)!==null&&_currRow$name!==void 0?_currRow$name:'',userName:(_currRow$username=currRow===null||currRow===void 0?void 0:currRow.username)!==null&&_currRow$username!==void 0?_currRow$username:''})):/*#__PURE__*/ // for displaying user table\nReact.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:classes.UMDiv},/*#__PURE__*/React.createElement(\"div\",{className:classes.members},/*#__PURE__*/React.createElement(\"img\",{src:\"./icons/user.svg\",alt:\"members\"}),/*#__PURE__*/React.createElement(Typography,{className:classes.memTypo},t('settings.userManagementTab.header'),\" (\",/*#__PURE__*/React.createElement(\"span\",null,rows?rows.length:0),\")\")),/*#__PURE__*/React.createElement(Typography,{className:classes.descText},t('settings.userManagementTab.info')),/*#__PURE__*/React.createElement(Toolbar,{\"data-cy\":\"toolBarComponent\",className:classes.toolbar},/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbarFirstCol},/*#__PURE__*/React.createElement(TextField,{\"data-cy\":\"searchField\",id:\"input-with-icon-adornment\",placeholder:t('settings.userManagementTab.label.search'),value:filters.search,onChange:function onChange(e){setFilters(_objectSpread(_objectSpread({},filters),{},{search:e.target.value}));setPaginationData(_objectSpread(_objectSpread({},paginationData),{},{pageNo:0}));},InputProps:{style:{maxWidth:'15.75rem'},startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(SearchIcon,null))}})),/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbarSecondCol},/*#__PURE__*/React.createElement(\"div\",{className:classes.filter},/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",className:classes.formControl,color:\"primary\",focused:true},/*#__PURE__*/React.createElement(InputLabel,{className:classes.selectText},t('settings.userManagementTab.label.userStatus')),/*#__PURE__*/React.createElement(Select,{label:\"User Status\",value:filters.status,onChange:function onChange(event){setFilters(_objectSpread(_objectSpread({},filters),{},{status:event.target.value}));setPaginationData(_objectSpread(_objectSpread({},paginationData),{},{pageNo:0}));},className:classes.selectText,color:\"primary\"},/*#__PURE__*/React.createElement(MenuItem,{value:\"all\"},t('settings.userManagementTab.label.options.all')),/*#__PURE__*/React.createElement(MenuItem,{value:\"signedout\"},t('settings.userManagementTab.label.options.notSignedIn')),/*#__PURE__*/React.createElement(MenuItem,{value:\"signedin\"},t('settings.userManagementTab.label.options.signedIn'))))),/*#__PURE__*/React.createElement(\"div\",{\"data-cy\":\"createUser\"},/*#__PURE__*/React.createElement(ButtonFilled,{onClick:function onClick(){setShowDiv(true);}},/*#__PURE__*/React.createElement(\"div\",null,t('settings.userManagementTab.button.create')))))),/*#__PURE__*/React.createElement(Paper,{className:classes.root},/*#__PURE__*/React.createElement(TableContainer,{className:classes.table},/*#__PURE__*/React.createElement(Table,{stickyHeader:true,\"aria-label\":\"sticky table\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,{className:classes.TR},/*#__PURE__*/React.createElement(StyledTableCell,{className:classes.styledTC},t('settings.userManagementTab.tableCell.status')),/*#__PURE__*/React.createElement(StyledTableCell,null,t('settings.userManagementTab.tableCell.username')),/*#__PURE__*/React.createElement(StyledTableCell,null,t('settings.userManagementTab.tableCell.email')),/*#__PURE__*/React.createElement(StyledTableCell,null,t('settings.userManagementTab.tableCell.userCreated')),/*#__PURE__*/React.createElement(StyledTableCell,null),/*#__PURE__*/React.createElement(TableHead,null))),/*#__PURE__*/React.createElement(TableBody,null,filteredData&&filteredData.length?filteredData.slice(paginationData.pageNo*paginationData.rowsPerPage,paginationData.pageNo*paginationData.rowsPerPage+paginationData.rowsPerPage).map(function(row,index){return/*#__PURE__*/React.createElement(TableRow,{\"data-cy\":\"userTableRow\",key:row.name,className:classes.TR},/*#__PURE__*/React.createElement(TableCell,{className:classes.firstTC,component:\"th\",scope:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:classes.firstCol},row.logged_in?/*#__PURE__*/React.createElement(LightPills,{variant:\"success\",label:t('settings.userManagementTab.label.options.signedIn')}):/*#__PURE__*/React.createElement(LightPills,{variant:\"danger\",label:t('settings.userManagementTab.label.options.notSignedIn')}),row.name)),/*#__PURE__*/React.createElement(TableCell,{className:classes.otherTC},row.username),/*#__PURE__*/React.createElement(TableCell,{className:classes.otherTC},row.email),/*#__PURE__*/React.createElement(TableCell,{className:classes.otherTC},/*#__PURE__*/React.createElement(\"div\",{className:classes.dateDiv},/*#__PURE__*/React.createElement(\"img\",{className:classes.calIcon,src:\"./icons/calendarIcon.svg\",alt:\"calendar\"}),formatDate(row.created_at))),/*#__PURE__*/React.createElement(TableCell,{className:classes.lastTC,key:row.username},/*#__PURE__*/React.createElement(IconButton,{\"data-cy\":\"editUser\",\"aria-label\":\"more\",\"aria-controls\":\"long-menu\",\"aria-haspopup\":\"true\",onClick:function onClick(event){setCurrRow(row);setAnchorEl(event.currentTarget);},className:classes.optionBtn},/*#__PURE__*/React.createElement(MoreVertIcon,null)),/*#__PURE__*/React.createElement(Menu,{keepMounted:true,open:Boolean(anchorEl),id:\"long-menu\",anchorEl:anchorEl,onClose:handleClose},/*#__PURE__*/React.createElement(MenuItem,{\"data-cy\":\"editProfile\",value:index,onClick:function onClick(){setEditDiv(true);setAnchorEl(null);}},/*#__PURE__*/React.createElement(IconButton,{disabled:true},/*#__PURE__*/React.createElement(\"img\",{alt:\"delete\",src:\"./icons/Edit.svg\"})),t('settings.userManagementTab.editProfile')))));}):/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{colSpan:5,align:\"center\"},/*#__PURE__*/React.createElement(Typography,null,t('settings.userManagementTab.noUsers'))))))),/*#__PURE__*/React.createElement(TablePagination,{rowsPerPageOptions:[5,10,25],component:\"div\",count:(_filteredData$length=filteredData===null||filteredData===void 0?void 0:filteredData.length)!==null&&_filteredData$length!==void 0?_filteredData$length:0,rowsPerPage:paginationData.rowsPerPage,page:paginationData.pageNo,onChangePage:function onChangePage(_,page){return setPaginationData(_objectSpread(_objectSpread({},paginationData),{},{pageNo:page}));},onChangeRowsPerPage:function onChangeRowsPerPage(event){return setPaginationData(_objectSpread(_objectSpread({},paginationData),{},{pageNo:0,rowsPerPage:parseInt(event.target.value,10)}));}}))))));};export default UserManagement;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Settings/UserManagementTab/UserManagement/index.tsx"],"names":["createStyles","FormControl","IconButton","InputAdornment","InputLabel","Menu","MenuItem","Paper","Select","Table","TableBody","TableCell","TableContainer","TableHead","TablePagination","TableRow","TextField","Toolbar","Typography","withStyles","MoreVertIcon","SearchIcon","ButtonFilled","LightPills","moment","React","useEffect","useState","useTranslation","config","UserRole","getToken","CreateUser","EditUser","useStyles","StyledTableCell","theme","head","backgroundColor","palette","cards","background","color","text","primary","body","fontSize","UserManagement","classes","t","showDiv","setShowDiv","rows","setRows","search","status","filters","setFilters","pageNo","rowsPerPage","paginationData","setPaginationData","editDiv","setEditDiv","anchorEl","setAnchorEl","fetch","auth","url","headers","Authorization","then","response","json","res","catch","err","console","error","filteredData","filter","dataRow","username","admin","toLowerCase","includes","datarow","logged_in","handleClose","currRow","setCurrRow","formatDate","date","day","format","email","name","UMDiv","members","memTypo","length","descText","toolbar","toolbarFirstCol","e","target","value","style","maxWidth","startAdornment","toolbarSecondCol","formControl","selectText","event","root","table","TR","styledTC","slice","map","row","index","firstTC","firstCol","otherTC","dateDiv","calIcon","created_at","lastTC","currentTarget","optionBtn","Boolean","_","page","parseInt"],"mappings":"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","sourcesContent":["import {\n  createStyles,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  InputLabel,\n  Menu,\n  MenuItem,\n  Paper,\n  Select,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TablePagination,\n  TableRow,\n  TextField,\n  Theme,\n  Toolbar,\n  Typography,\n  withStyles,\n} from '@material-ui/core';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { ButtonFilled, LightPills } from 'litmus-ui';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport config from '../../../../config';\nimport { UserRole } from '../../../../models/graphql/user';\nimport { getToken } from '../../../../utils/auth';\nimport CreateUser from '../CreateUser';\nimport EditUser from '../EditUser';\nimport useStyles from './styles';\n\n// StyledTableCell used to create custom table cell\nconst StyledTableCell = withStyles((theme: Theme) =>\n  createStyles({\n    head: {\n      backgroundColor: theme.palette.cards.background,\n      color: theme.palette.text.primary,\n    },\n    body: {\n      fontSize: '0.875rem',\n    },\n  })\n)(TableCell);\n\ninterface UserData {\n  _id: string;\n  username: string;\n  email: string;\n  name: string;\n  logged_in: boolean;\n  created_at: string;\n  updated_at: string;\n  removed_at: string;\n  state: string;\n}\n\ninterface FilterOptions {\n  search: string;\n  status: string;\n}\n\ninterface PaginationData {\n  pageNo: number;\n  rowsPerPage: number;\n}\n// UserManagement displays users table\nconst UserManagement: React.FC = () => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n\n  const [showDiv, setShowDiv] = React.useState<boolean>(false);\n  // for response data\n  const [rows, setRows] = useState<UserData[]>([]);\n  // States for filters\n  const [filters, setFilters] = useState<FilterOptions>({\n    search: '',\n    status: 'all',\n  });\n  // State for pagination\n  const [paginationData, setPaginationData] = useState<PaginationData>({\n    pageNo: 0,\n    rowsPerPage: 5,\n  });\n  const [editDiv, setEditDiv] = React.useState<boolean>(false);\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  useEffect(() => {\n    fetch(`${config.auth.url}/users`, {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getToken()}`,\n      },\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((res) => {\n        setRows(res);\n      })\n\n      .catch((err) => {\n        console.error(err);\n      });\n  }, [showDiv]);\n\n  const filteredData = rows\n    ?.filter((dataRow) => dataRow.username !== UserRole.admin)\n    ?.filter((dataRow) =>\n      dataRow.username.toLowerCase().includes(filters.search.toLowerCase())\n    )\n    .filter((datarow) => {\n      if (filters.status === 'all') return true;\n      if (filters.status === 'signedin') return datarow.logged_in === true;\n      return datarow.logged_in === false;\n    });\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const [currRow, setCurrRow] = React.useState<UserData>();\n\n  const formatDate = (date: string) => {\n    const day = moment(date).format('Do MMM, YYYY LT');\n    return day;\n  };\n\n  return (\n    <div>\n      {showDiv ? (\n        <div>\n          {/* for create new user div */}\n          <CreateUser handleDiv={() => setShowDiv(false)} />\n        </div>\n      ) : (\n        <div>\n          {editDiv ? (\n            <div>\n              <EditUser\n                handleDiv={() => setEditDiv(false)}\n                email={currRow?.email ?? ''}\n                fullName={currRow?.name ?? ''}\n                userName={currRow?.username ?? ''}\n              />\n            </div>\n          ) : (\n            // for displaying user table\n            <div>\n              <div className={classes.UMDiv}>\n                <div className={classes.members}>\n                  <img src=\"./icons/user.svg\" alt=\"members\" />\n                  <Typography className={classes.memTypo}>\n                    {t('settings.userManagementTab.header')} (\n                    <span>{rows ? rows.length : 0}</span>)\n                  </Typography>\n                </div>\n                <Typography className={classes.descText}>\n                  {t('settings.userManagementTab.info')}\n                </Typography>\n\n                <Toolbar data-cy=\"toolBarComponent\" className={classes.toolbar}>\n                  {/* Search user */}\n                  <div className={classes.toolbarFirstCol}>\n                    <TextField\n                      data-cy=\"searchField\"\n                      id=\"input-with-icon-adornment\"\n                      placeholder={t('settings.userManagementTab.label.search')}\n                      value={filters.search}\n                      onChange={(e) => {\n                        setFilters({\n                          ...filters,\n                          search: e.target.value,\n                        });\n                        setPaginationData({ ...paginationData, pageNo: 0 });\n                      }}\n                      InputProps={{\n                        style: {\n                          maxWidth: '15.75rem',\n                        },\n                        startAdornment: (\n                          <InputAdornment position=\"start\">\n                            <SearchIcon />\n                          </InputAdornment>\n                        ),\n                      }}\n                    />\n                  </div>\n\n                  {/* filter menu */}\n                  <div className={classes.toolbarSecondCol}>\n                    <div className={classes.filter}>\n                      <FormControl\n                        variant=\"outlined\"\n                        className={classes.formControl}\n                        color=\"primary\"\n                        focused\n                      >\n                        <InputLabel className={classes.selectText}>\n                          {t('settings.userManagementTab.label.userStatus')}\n                        </InputLabel>\n                        <Select\n                          label=\"User Status\"\n                          value={filters.status}\n                          onChange={(event) => {\n                            setFilters({\n                              ...filters,\n                              status: event.target.value as string,\n                            });\n                            setPaginationData({ ...paginationData, pageNo: 0 });\n                          }}\n                          className={classes.selectText}\n                          color=\"primary\"\n                        >\n                          <MenuItem value=\"all\">\n                            {t('settings.userManagementTab.label.options.all')}\n                          </MenuItem>\n                          <MenuItem value=\"signedout\">\n                            {t(\n                              'settings.userManagementTab.label.options.notSignedIn'\n                            )}\n                          </MenuItem>\n                          <MenuItem value=\"signedin\">\n                            {t(\n                              'settings.userManagementTab.label.options.signedIn'\n                            )}\n                          </MenuItem>\n                        </Select>\n                      </FormControl>\n                    </div>\n                    <div data-cy=\"createUser\">\n                      <ButtonFilled\n                        onClick={() => {\n                          setShowDiv(true);\n                        }}\n                      >\n                        <div>\n                          {t('settings.userManagementTab.button.create')}\n                        </div>\n                      </ButtonFilled>\n                    </div>\n                  </div>\n                </Toolbar>\n                {/* user table */}\n                <Paper className={classes.root}>\n                  <TableContainer className={classes.table}>\n                    <Table stickyHeader aria-label=\"sticky table\">\n                      <TableHead>\n                        <TableRow className={classes.TR}>\n                          <StyledTableCell className={classes.styledTC}>\n                            {t('settings.userManagementTab.tableCell.status')}\n                          </StyledTableCell>\n                          <StyledTableCell>\n                            {t('settings.userManagementTab.tableCell.username')}\n                          </StyledTableCell>\n                          <StyledTableCell>\n                            {t('settings.userManagementTab.tableCell.email')}\n                          </StyledTableCell>\n                          <StyledTableCell>\n                            {t(\n                              'settings.userManagementTab.tableCell.userCreated'\n                            )}\n                          </StyledTableCell>\n                          <StyledTableCell />\n                          <TableHead />\n                        </TableRow>\n                      </TableHead>\n                      <TableBody>\n                        {filteredData && filteredData.length ? (\n                          filteredData\n                            .slice(\n                              paginationData.pageNo *\n                                paginationData.rowsPerPage,\n                              paginationData.pageNo *\n                                paginationData.rowsPerPage +\n                                paginationData.rowsPerPage\n                            )\n                            .map((row, index) => (\n                              <TableRow\n                                data-cy=\"userTableRow\"\n                                key={row.name}\n                                className={classes.TR}\n                              >\n                                <TableCell\n                                  className={classes.firstTC}\n                                  component=\"th\"\n                                  scope=\"row\"\n                                >\n                                  <div className={classes.firstCol}>\n                                    {row.logged_in ? (\n                                      <LightPills\n                                        variant=\"success\"\n                                        label={t(\n                                          'settings.userManagementTab.label.options.signedIn'\n                                        )}\n                                      />\n                                    ) : (\n                                      <LightPills\n                                        variant=\"danger\"\n                                        label={t(\n                                          'settings.userManagementTab.label.options.notSignedIn'\n                                        )}\n                                      />\n                                    )}\n                                    {row.name}\n                                  </div>\n                                </TableCell>\n\n                                <TableCell className={classes.otherTC}>\n                                  {row.username}\n                                </TableCell>\n                                <TableCell className={classes.otherTC}>\n                                  {row.email}\n                                </TableCell>\n                                <TableCell className={classes.otherTC}>\n                                  <div className={classes.dateDiv}>\n                                    <img\n                                      className={classes.calIcon}\n                                      src=\"./icons/calendarIcon.svg\"\n                                      alt=\"calendar\"\n                                    />\n                                    {formatDate(row.created_at)}\n                                  </div>\n                                </TableCell>\n                                <TableCell\n                                  className={classes.lastTC}\n                                  key={row.username}\n                                >\n                                  <IconButton\n                                    data-cy=\"editUser\"\n                                    aria-label=\"more\"\n                                    aria-controls=\"long-menu\"\n                                    aria-haspopup=\"true\"\n                                    onClick={(event) => {\n                                      setCurrRow(row);\n                                      setAnchorEl(event.currentTarget);\n                                    }}\n                                    className={classes.optionBtn}\n                                  >\n                                    <MoreVertIcon />\n                                  </IconButton>\n                                  <Menu\n                                    keepMounted\n                                    open={Boolean(anchorEl)}\n                                    id=\"long-menu\"\n                                    anchorEl={anchorEl}\n                                    onClose={handleClose}\n                                  >\n                                    <MenuItem\n                                      data-cy=\"editProfile\"\n                                      value={index}\n                                      onClick={() => {\n                                        setEditDiv(true);\n                                        setAnchorEl(null);\n                                      }}\n                                    >\n                                      <IconButton disabled>\n                                        <img\n                                          alt=\"delete\"\n                                          src=\"./icons/Edit.svg\"\n                                        />\n                                      </IconButton>\n                                      {t(\n                                        'settings.userManagementTab.editProfile'\n                                      )}\n                                    </MenuItem>\n                                    {/* \n                                    <MenuItem\n                                      value=\"delete\"\n                                      disabled\n                                      onClick={() => {}}\n                                    >\n                                      <IconButton disabled>\n                                        <img\n                                          alt=\"delete\"\n                                          src=\"./icons/bin.svg\"\n                                        />\n                                      </IconButton>\n                                      <Typography>Delete User</Typography>\n                                    </MenuItem> */}\n                                  </Menu>\n                                </TableCell>\n                              </TableRow>\n                            ))\n                        ) : (\n                          <TableRow>\n                            <TableCell colSpan={5} align=\"center\">\n                              <Typography>\n                                {t('settings.userManagementTab.noUsers')}\n                              </Typography>\n                            </TableCell>\n                          </TableRow>\n                        )}\n                      </TableBody>\n                    </Table>\n                  </TableContainer>\n                  <TablePagination\n                    rowsPerPageOptions={[5, 10, 25]}\n                    component=\"div\"\n                    count={filteredData?.length ?? 0}\n                    rowsPerPage={paginationData.rowsPerPage}\n                    page={paginationData.pageNo}\n                    onChangePage={(_, page) =>\n                      setPaginationData({\n                        ...paginationData,\n                        pageNo: page,\n                      })\n                    }\n                    onChangeRowsPerPage={(event) =>\n                      setPaginationData({\n                        ...paginationData,\n                        pageNo: 0,\n                        rowsPerPage: parseInt(event.target.value, 10),\n                      })\n                    }\n                  />\n                </Paper>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\nexport default UserManagement;\n"]},"metadata":{},"sourceType":"module"}