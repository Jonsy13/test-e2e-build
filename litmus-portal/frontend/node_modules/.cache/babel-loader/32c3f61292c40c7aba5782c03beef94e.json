{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useQuery}from'@apollo/client';import{Paper,Typography}from'@material-ui/core';import{ButtonOutlined}from'litmus-ui';import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import{LIST_PROJECTS}from'../../../graphql';import{InvitationStatus,Role}from'../../../models/graphql/user';import useActions from'../../../redux/actions';import*as TabActions from'../../../redux/actions/tabs';import{history}from'../../../redux/configureStore';import{getUserId}from'../../../utils/auth';import{getProjectID,getProjectRole}from'../../../utils/getSearchParams';import useStyles from'./styles';var ProjectInfoContainer=function ProjectInfoContainer(){var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var tabs=useActions(TabActions);var userID=getUserId();var projectID=getProjectID();var projectRole=getProjectRole();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),projectOwnerCount=_useState2[0],setProjectOwnerCount=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),projectOtherCount=_useState4[0],setProjectOtherCount=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),invitationsCount=_useState6[0],setInvitationCount=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),projects=_useState8[0],setProjects=_useState8[1];var _useQuery=useQuery(LIST_PROJECTS,{onCompleted:function onCompleted(){if(dataProject===null||dataProject===void 0?void 0:dataProject.listProjects){setProjects(dataProject===null||dataProject===void 0?void 0:dataProject.listProjects);}},fetchPolicy:'cache-and-network'}),dataProject=_useQuery.data;useEffect(function(){var projectOwner=0;var projectInvitation=0;var projectOther=0;projects.forEach(function(project){project.members.forEach(function(member){if(member.user_id===userID&&member.role===Role.owner){projectOwner++;}else if(member.user_id===userID&&member.invitation===InvitationStatus.PENDING){projectInvitation++;}else if(member.user_id===userID&&member.role!==Role.owner&&member.invitation===InvitationStatus.ACCEPTED){projectOther++;}});});setProjectOwnerCount(projectOwner);setInvitationCount(projectInvitation);setProjectOtherCount(projectOther);},[projects,dataProject]);var projectCount=projectOwnerCount+projectOtherCount;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Paper,{className:classes.projectInfoContainer},/*#__PURE__*/React.createElement(\"div\",{className:classes.projectInfoBlock},/*#__PURE__*/React.createElement(\"div\",{className:classes.projectInfoData},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{id:\"projectCount\"},projectCount),projectCount===1?/*#__PURE__*/React.createElement(Typography,null,t('homeViews.projectInfoContainer.project')):/*#__PURE__*/React.createElement(Typography,null,t('homeViews.projectInfoContainer.projects'))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{id:\"invitationCount\"},invitationsCount),invitationsCount===1?/*#__PURE__*/React.createElement(Typography,null,t('homeViews.projectInfoContainer.invitation')):/*#__PURE__*/React.createElement(Typography,null,t('homeViews.projectInfoContainer.invitations'))))),projectRole===Role.owner&&/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:function onClick(){tabs.changeSettingsTabs(1);history.push({pathname:'/settings',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});},className:classes.viewProjectButton},/*#__PURE__*/React.createElement(Typography,null,/*#__PURE__*/React.createElement(\"img\",{src:\"./icons/viewProjects.svg\",alt:\"View projects\"}),t('homeViews.projectInfoContainer.viewProjects')))));};export{ProjectInfoContainer};","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Home/ProjectInfoContainer/index.tsx"],"names":["useQuery","Paper","Typography","ButtonOutlined","React","useEffect","useState","useTranslation","LIST_PROJECTS","InvitationStatus","Role","useActions","TabActions","history","getUserId","getProjectID","getProjectRole","useStyles","ProjectInfoContainer","classes","t","tabs","userID","projectID","projectRole","projectOwnerCount","setProjectOwnerCount","projectOtherCount","setProjectOtherCount","invitationsCount","setInvitationCount","projects","setProjects","onCompleted","dataProject","listProjects","fetchPolicy","data","projectOwner","projectInvitation","projectOther","forEach","project","members","member","user_id","role","owner","invitation","PENDING","ACCEPTED","projectCount","projectInfoContainer","projectInfoBlock","projectInfoData","changeSettingsTabs","push","pathname","search","viewProjectButton"],"mappings":"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","sourcesContent":["import { useQuery } from '@apollo/client';\nimport { Paper, Typography } from '@material-ui/core';\nimport { ButtonOutlined } from 'litmus-ui';\nimport React, { useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { LIST_PROJECTS } from '../../../graphql';\nimport {\n  InvitationStatus,\n  Member,\n  Project,\n  Projects,\n  Role,\n} from '../../../models/graphql/user';\nimport useActions from '../../../redux/actions';\nimport * as TabActions from '../../../redux/actions/tabs';\nimport { history } from '../../../redux/configureStore';\nimport { getUserId } from '../../../utils/auth';\nimport { getProjectID, getProjectRole } from '../../../utils/getSearchParams';\nimport useStyles from './styles';\n\nconst ProjectInfoContainer: React.FC = () => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const tabs = useActions(TabActions);\n\n  const userID = getUserId();\n\n  const projectID = getProjectID();\n  const projectRole = getProjectRole();\n\n  const [projectOwnerCount, setProjectOwnerCount] = useState<number>(0);\n  const [projectOtherCount, setProjectOtherCount] = useState<number>(0);\n  const [invitationsCount, setInvitationCount] = useState<number>(0);\n  const [projects, setProjects] = useState<Project[]>([]);\n\n  const { data: dataProject } = useQuery<Projects>(LIST_PROJECTS, {\n    onCompleted: () => {\n      if (dataProject?.listProjects) {\n        setProjects(dataProject?.listProjects);\n      }\n    },\n    fetchPolicy: 'cache-and-network',\n  });\n\n  useEffect(() => {\n    let projectOwner = 0;\n    let projectInvitation = 0;\n    let projectOther = 0;\n    projects.forEach((project) => {\n      project.members.forEach((member: Member) => {\n        if (member.user_id === userID && member.role === Role.owner) {\n          projectOwner++;\n        } else if (\n          member.user_id === userID &&\n          member.invitation === InvitationStatus.PENDING\n        ) {\n          projectInvitation++;\n        } else if (\n          member.user_id === userID &&\n          member.role !== Role.owner &&\n          member.invitation === InvitationStatus.ACCEPTED\n        ) {\n          projectOther++;\n        }\n      });\n    });\n    setProjectOwnerCount(projectOwner);\n    setInvitationCount(projectInvitation);\n    setProjectOtherCount(projectOther);\n  }, [projects, dataProject]);\n\n  const projectCount = projectOwnerCount + projectOtherCount;\n\n  return (\n    <div>\n      {/* Project Level info container */}\n      <Paper className={classes.projectInfoContainer}>\n        <div className={classes.projectInfoBlock}>\n          <div className={classes.projectInfoData}>\n            <div>\n              <Typography id=\"projectCount\">{projectCount}</Typography>\n              {projectCount === 1 ? (\n                <Typography>\n                  {t('homeViews.projectInfoContainer.project')}\n                </Typography>\n              ) : (\n                <Typography>\n                  {t('homeViews.projectInfoContainer.projects')}\n                </Typography>\n              )}\n            </div>\n            <div>\n              <Typography id=\"invitationCount\">{invitationsCount}</Typography>\n              {invitationsCount === 1 ? (\n                <Typography>\n                  {t('homeViews.projectInfoContainer.invitation')}\n                </Typography>\n              ) : (\n                <Typography>\n                  {t('homeViews.projectInfoContainer.invitations')}\n                </Typography>\n              )}\n            </div>\n          </div>\n        </div>\n        {projectRole === Role.owner && (\n          <ButtonOutlined\n            onClick={() => {\n              tabs.changeSettingsTabs(1);\n              history.push({\n                pathname: '/settings',\n                search: `?projectID=${projectID}&projectRole=${projectRole}`,\n              });\n            }}\n            className={classes.viewProjectButton}\n          >\n            <Typography>\n              <img src=\"./icons/viewProjects.svg\" alt=\"View projects\" />\n              {t('homeViews.projectInfoContainer.viewProjects')}\n            </Typography>\n          </ButtonOutlined>\n        )}\n      </Paper>\n    </div>\n  );\n};\n\nexport { ProjectInfoContainer };\n"]},"metadata":{},"sourceType":"module"}