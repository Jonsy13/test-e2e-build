{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"children\",\"value\",\"index\"];import{useQuery}from'@apollo/client';import{Box,Paper,Tab,Tabs,useTheme}from'@material-ui/core';import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import{LIST_PROJECTS}from'../../../../graphql';import{getUserId}from'../../../../utils/auth';import AcceptedInvitations from'./AcceptedInvitations';import ReceivedInvitations from'./ReceivedInvitations';import useStyles from'./styles';// TabPanel ise used to implement the functioning of tabs\nvar TabPanel=function TabPanel(_ref){var children=_ref.children,value=_ref.value,index=_ref.index,other=_objectWithoutProperties(_ref,_excluded);return/*#__PURE__*/React.createElement(\"div\",Object.assign({role:\"tabpanel\",hidden:value!==index,id:\"simple-tabpanel-\".concat(index),\"aria-labelledby\":\"simple-tab-\".concat(index)},other),value===index&&/*#__PURE__*/React.createElement(Box,{p:3},children));};// tabProps returns 'id' and 'aria-control' props of Tab\nfunction tabProps(index){return{id:\"simple-tab-\".concat(index),'aria-controls':\"simple-tabpanel-\".concat(index)};}// NewUserModal displays a modal on creating a new user\nvar Invitation=function Invitation(){var classes=useStyles();var theme=useTheme();var _useTranslation=useTranslation(),t=_useTranslation.t;var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),activeTab=_React$useState2[0],setActiveTab=_React$useState2[1];var handleChange=function handleChange(event,actTab){setActiveTab(actTab);};var userID=getUserId();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),projectOtherCount=_useState2[0],setProjectOtherCount=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),invitationsCount=_useState4[0],setInvitationCount=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),projects=_useState6[0],setProjects=_useState6[1];var _useQuery=useQuery(LIST_PROJECTS,{onCompleted:function onCompleted(){if(dataProject===null||dataProject===void 0?void 0:dataProject.listProjects){setProjects(dataProject===null||dataProject===void 0?void 0:dataProject.listProjects);}},fetchPolicy:'cache-and-network'}),dataProject=_useQuery.data;useEffect(function(){var otherCount=0;var inviteCount=0;projects.map(function(project){return project.members.forEach(function(member){if(member.user_id===userID&&member.invitation==='Pending'){inviteCount++;}else if(member.user_id===userID&&member.role!=='Owner'&&member.invitation==='Accepted'){otherCount++;}});});setInvitationCount(inviteCount);setProjectOtherCount(otherCount);},[projects,dataProject]);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Paper,{className:classes.root,elevation:0},/*#__PURE__*/React.createElement(Tabs,{value:activeTab,onChange:handleChange,TabIndicatorProps:{style:{backgroundColor:theme.palette.primary.main}}},/*#__PURE__*/React.createElement(Tab,Object.assign({\"data-cy\":\"activeTab\",label:/*#__PURE__*/React.createElement(\"span\",{className:activeTab===0?classes.active:classes.inActive},/*#__PURE__*/React.createElement(\"span\",{className:classes.invitationCount},projectOtherCount),' ',t('settings.teamingTab.active'))},tabProps(0))),/*#__PURE__*/React.createElement(Tab,Object.assign({\"data-cy\":\"receivedTab\",label:/*#__PURE__*/React.createElement(\"span\",{className:activeTab===1?classes.active:classes.inActive},/*#__PURE__*/React.createElement(\"span\",{className:classes.invitationCount},invitationsCount),' ',t('settings.teamingTab.invitations'))},tabProps(1))))),/*#__PURE__*/React.createElement(TabPanel,{value:activeTab,index:0},/*#__PURE__*/React.createElement(AcceptedInvitations,null)),/*#__PURE__*/React.createElement(TabPanel,{value:activeTab,index:1},/*#__PURE__*/React.createElement(ReceivedInvitations,null)));};export default Invitation;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Settings/TeamingTab/Invitation/index.tsx"],"names":["useQuery","Box","Paper","Tab","Tabs","useTheme","React","useEffect","useState","useTranslation","LIST_PROJECTS","getUserId","AcceptedInvitations","ReceivedInvitations","useStyles","TabPanel","children","value","index","other","tabProps","id","Invitation","classes","theme","t","activeTab","setActiveTab","handleChange","event","actTab","userID","projectOtherCount","setProjectOtherCount","invitationsCount","setInvitationCount","projects","setProjects","onCompleted","dataProject","listProjects","fetchPolicy","data","otherCount","inviteCount","map","project","members","forEach","member","user_id","invitation","role","root","style","backgroundColor","palette","primary","main","active","inActive","invitationCount"],"mappings":"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","sourcesContent":["import { useQuery } from '@apollo/client';\nimport { Box, Paper, Tab, Tabs, useTheme } from '@material-ui/core';\nimport React, { useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { LIST_PROJECTS } from '../../../../graphql';\nimport { Member, Project, Projects } from '../../../../models/graphql/user';\nimport { getUserId } from '../../../../utils/auth';\nimport AcceptedInvitations from './AcceptedInvitations';\nimport ReceivedInvitations from './ReceivedInvitations';\nimport useStyles from './styles';\n\ninterface TabPanelProps {\n  index: any;\n  value: any;\n}\n\n// TabPanel ise used to implement the functioning of tabs\nconst TabPanel: React.FC<TabPanelProps> = ({\n  children,\n  value,\n  index,\n  ...other\n}) => {\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && <Box p={3}>{children}</Box>}\n    </div>\n  );\n};\n\n// tabProps returns 'id' and 'aria-control' props of Tab\nfunction tabProps(index: any) {\n  return {\n    id: `simple-tab-${index}`,\n    'aria-controls': `simple-tabpanel-${index}`,\n  };\n}\n\n// NewUserModal displays a modal on creating a new user\nconst Invitation: React.FC = () => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const { t } = useTranslation();\n  const [activeTab, setActiveTab] = React.useState(0);\n  const handleChange = (event: React.ChangeEvent<{}>, actTab: number) => {\n    setActiveTab(actTab);\n  };\n\n  const userID = getUserId();\n\n  const [projectOtherCount, setProjectOtherCount] = useState<number>(0);\n  const [invitationsCount, setInvitationCount] = useState<number>(0);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const { data: dataProject } = useQuery<Projects>(LIST_PROJECTS, {\n    onCompleted: () => {\n      if (dataProject?.listProjects) {\n        setProjects(dataProject?.listProjects);\n      }\n    },\n    fetchPolicy: 'cache-and-network',\n  });\n  useEffect(() => {\n    let otherCount = 0;\n    let inviteCount = 0;\n    projects.map((project) => {\n      return project.members.forEach((member: Member) => {\n        if (member.user_id === userID && member.invitation === 'Pending') {\n          inviteCount++;\n        } else if (\n          member.user_id === userID &&\n          member.role !== 'Owner' &&\n          member.invitation === 'Accepted'\n        ) {\n          otherCount++;\n        }\n      });\n    });\n    setInvitationCount(inviteCount);\n    setProjectOtherCount(otherCount);\n  }, [projects, dataProject]);\n  return (\n    <div>\n      <Paper className={classes.root} elevation={0}>\n        <Tabs\n          value={activeTab}\n          onChange={handleChange}\n          TabIndicatorProps={{\n            style: {\n              backgroundColor: theme.palette.primary.main,\n            },\n          }}\n        >\n          <Tab\n            data-cy=\"activeTab\"\n            label={\n              <span\n                className={activeTab === 0 ? classes.active : classes.inActive}\n              >\n                <span className={classes.invitationCount}>\n                  {projectOtherCount}\n                </span>{' '}\n                {t('settings.teamingTab.active')}\n              </span>\n            }\n            {...tabProps(0)}\n          />\n          <Tab\n            data-cy=\"receivedTab\"\n            label={\n              <span\n                className={activeTab === 1 ? classes.active : classes.inActive}\n              >\n                <span className={classes.invitationCount}>\n                  {invitationsCount}\n                </span>{' '}\n                {t('settings.teamingTab.invitations')}\n              </span>\n            }\n            {...tabProps(1)}\n          />\n        </Tabs>\n      </Paper>\n      <TabPanel value={activeTab} index={0}>\n        <AcceptedInvitations />\n      </TabPanel>\n      <TabPanel value={activeTab} index={1}>\n        <ReceivedInvitations />\n      </TabPanel>\n    </div>\n  );\n};\nexport default Invitation;\n"]},"metadata":{},"sourceType":"module"}