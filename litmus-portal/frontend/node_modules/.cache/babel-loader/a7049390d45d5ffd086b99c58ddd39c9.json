{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useQuery}from'@apollo/client';import{Link,Typography}from'@material-ui/core';import ArrowUpwardIcon from'@material-ui/icons/ArrowUpward';import{ButtonFilled,ButtonOutlined,Modal}from'litmus-ui';import React,{useState}from'react';import{useTranslation}from'react-i18next';import{AgentDeployModal}from'../../../components/AgentDeployModal';import Loader from'../../../components/Loader';import{MainInfoContainer}from'../../../components/MainInfoContainer';import{OverviewContainer}from'../../../components/OverviewContainer';import{RecentOverviewContainer}from'../../../components/RecentOverviewContainer';import Center from'../../../containers/layouts/Center';import{WORKFLOW_DETAILS}from'../../../graphql';import{Role}from'../../../models/graphql/user';import useActions from'../../../redux/actions';import*as TabActions from'../../../redux/actions/tabs';import{history}from'../../../redux/configureStore';import{getProjectID,getProjectRole}from'../../../utils/getSearchParams';import{ProjectInfoContainer}from'../ProjectInfoContainer';import useStyles from'./styles';import{WorkflowRunCard}from'./WorkflowRunCard';var AgentConfiguredHome=function AgentConfiguredHome(_ref){var _data$getWorkflowRuns;var agentCount=_ref.agentCount;var _useTranslation=useTranslation(),t=_useTranslation.t;var projectID=getProjectID();var projectRole=getProjectRole();var tabs=useActions(TabActions);var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var handleClose=function handleClose(){setModalOpen(false);};var handleOpen=function handleOpen(){setModalOpen(true);};var _useQuery=useQuery(WORKFLOW_DETAILS,{variables:{workflowRunsInput:{project_id:projectID,pagination:{page:0,limit:3}}},fetchPolicy:'cache-and-network'}),data=_useQuery.data,loading=_useQuery.loading,error=_useQuery.error;var workflowRunCount=(_data$getWorkflowRuns=data===null||data===void 0?void 0:data.getWorkflowRuns.total_no_of_workflow_runs)!==null&&_data$getWorkflowRuns!==void 0?_data$getWorkflowRuns:0;if(error){console.error('Error fetching Workflow Data');return/*#__PURE__*/React.createElement(Center,null,/*#__PURE__*/React.createElement(Typography,null,t('homeViews.agentConfiguredHome.error')));}return/*#__PURE__*/React.createElement(\"div\",null,loading?/*#__PURE__*/React.createElement(Center,null,/*#__PURE__*/React.createElement(Loader,null)):workflowRunCount>0?/*#__PURE__*/React.createElement(RecentOverviewContainer,{heading:t('homeViews.agentConfiguredHome.recentWorkflowRuns.heading'),link:/*#__PURE__*/React.createElement(Link,{underline:\"none\",color:\"primary\",onClick:function onClick(){tabs.changeWorkflowsTabs(0);history.push({pathname:'/workflows',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});}},/*#__PURE__*/React.createElement(Typography,{className:classes.linkPointer},t('homeViews.agentConfiguredHome.recentWorkflowRuns.viewAll'))),buttonLink:\"/create-workflow\",buttonImgSrc:\"./icons/calendarBlank.svg\",buttonImgAlt:\"calendar\",buttonText:t('homeViews.agentConfiguredHome.recentWorkflowRuns.schedule')},data===null||data===void 0?void 0:data.getWorkflowRuns.workflow_runs.map(function(workflow){return/*#__PURE__*/React.createElement(WorkflowRunCard,{key:workflow.workflow_id,data:workflow});})):/*#__PURE__*/React.createElement(MainInfoContainer,{src:\"./icons/workflowScheduleHome.svg\",alt:\"Schedule a workflow\",heading:t('homeViews.agentConfiguredHome.noWorkflow.heading'),description:t('homeViews.agentConfiguredHome.noWorkflow.description'),button:/*#__PURE__*/React.createElement(ButtonFilled,{onClick:function onClick(){history.push({pathname:'/create-workflow',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});}},/*#__PURE__*/React.createElement(Typography,null,t('homeViews.agentConfiguredHome.noWorkflow.schedule'))),link:/*#__PURE__*/React.createElement(Link,{underline:\"none\",color:\"primary\",onClick:function onClick(){tabs.changeWorkflowsTabs(2);history.push({pathname:'/workflows',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});}},/*#__PURE__*/React.createElement(Typography,null,t('homeViews.agentConfiguredHome.noWorkflow.explore')))}),/*#__PURE__*/React.createElement(OverviewContainer,{count:agentCount,countUnit:t('homeViews.agentConfiguredHome.agentInfoContainer.agent'),description:t('homeViews.agentConfiguredHome.agentInfoContainer.description'),maxWidth:\"25.5625rem\",button:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:handleOpen,className:classes.infoContainerButton},/*#__PURE__*/React.createElement(Typography,null,/*#__PURE__*/React.createElement(ArrowUpwardIcon,null),t('homeViews.agentConfiguredHome.agentInfoContainer.deploy'))),/*#__PURE__*/React.createElement(Modal,{height:\"50%\",width:\"50%\",open:modalOpen,onClose:handleClose,modalActions:/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:handleClose},\"\\u2715\")},/*#__PURE__*/React.createElement(AgentDeployModal,{handleClose:handleClose})))}),projectRole===Role.owner&&/*#__PURE__*/React.createElement(ProjectInfoContainer,null));};export{AgentConfiguredHome};","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Home/AgentConfiguredHome/index.tsx"],"names":["useQuery","Link","Typography","ArrowUpwardIcon","ButtonFilled","ButtonOutlined","Modal","React","useState","useTranslation","AgentDeployModal","Loader","MainInfoContainer","OverviewContainer","RecentOverviewContainer","Center","WORKFLOW_DETAILS","Role","useActions","TabActions","history","getProjectID","getProjectRole","ProjectInfoContainer","useStyles","WorkflowRunCard","AgentConfiguredHome","agentCount","t","projectID","projectRole","tabs","classes","modalOpen","setModalOpen","handleClose","handleOpen","variables","workflowRunsInput","project_id","pagination","page","limit","fetchPolicy","data","loading","error","workflowRunCount","getWorkflowRuns","total_no_of_workflow_runs","console","changeWorkflowsTabs","push","pathname","search","linkPointer","workflow_runs","map","workflow","workflow_id","infoContainerButton","owner"],"mappings":"mLAAA,OAASA,QAAT,KAAyB,gBAAzB,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,mBAAjC,CACA,MAAOC,CAAAA,eAAP,KAA4B,gCAA5B,CACA,OAASC,YAAT,CAAuBC,cAAvB,CAAuCC,KAAvC,KAAoD,WAApD,CACA,MAAOC,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,cAAT,KAA+B,eAA/B,CACA,OAASC,gBAAT,KAAiC,sCAAjC,CACA,MAAOC,CAAAA,MAAP,KAAmB,4BAAnB,CACA,OAASC,iBAAT,KAAkC,uCAAlC,CACA,OAASC,iBAAT,KAAkC,uCAAlC,CACA,OAASC,uBAAT,KAAwC,6CAAxC,CACA,MAAOC,CAAAA,MAAP,KAAmB,oCAAnB,CACA,OAASC,gBAAT,KAAiC,kBAAjC,CACA,OAASC,IAAT,KAAqB,8BAArB,CAKA,MAAOC,CAAAA,UAAP,KAAuB,wBAAvB,CACA,MAAO,GAAKC,CAAAA,UAAZ,KAA4B,6BAA5B,CACA,OAASC,OAAT,KAAwB,+BAAxB,CACA,OAASC,YAAT,CAAuBC,cAAvB,KAA6C,gCAA7C,CACA,OAASC,oBAAT,KAAqC,yBAArC,CACA,MAAOC,CAAAA,SAAP,KAAsB,UAAtB,CACA,OAASC,eAAT,KAAgC,mBAAhC,CAMA,GAAMC,CAAAA,mBAAuD,CAAG,QAA1DA,CAAAA,mBAA0D,MAE1D,8BADJC,CAAAA,UACI,MADJA,UACI,CACJ,oBAAclB,cAAc,EAA5B,CAAQmB,CAAR,iBAAQA,CAAR,CACA,GAAMC,CAAAA,SAAS,CAAGR,YAAY,EAA9B,CACA,GAAMS,CAAAA,WAAW,CAAGR,cAAc,EAAlC,CACA,GAAMS,CAAAA,IAAI,CAAGb,UAAU,CAACC,UAAD,CAAvB,CACA,GAAMa,CAAAA,OAAO,CAAGR,SAAS,EAAzB,CAEA,cAAkChB,QAAQ,CAAU,KAAV,CAA1C,wCAAOyB,SAAP,eAAkBC,YAAlB,eAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxBD,YAAY,CAAC,KAAD,CAAZ,CACD,CAFD,CAIA,GAAME,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBF,YAAY,CAAC,IAAD,CAAZ,CACD,CAFD,CAIA,cAAiClC,QAAQ,CACvCgB,gBADuC,CAEvC,CACEqB,SAAS,CAAE,CACTC,iBAAiB,CAAE,CACjBC,UAAU,CAAEV,SADK,CAEjBW,UAAU,CAAE,CACVC,IAAI,CAAE,CADI,CAEVC,KAAK,CAAE,CAFG,CAFK,CADV,CADb,CAUEC,WAAW,CAAE,mBAVf,CAFuC,CAAzC,CAAQC,IAAR,WAAQA,IAAR,CAAcC,OAAd,WAAcA,OAAd,CAAuBC,KAAvB,WAAuBA,KAAvB,CAgBA,GAAMC,CAAAA,gBAAgB,wBAAGH,IAAH,SAAGA,IAAH,iBAAGA,IAAI,CAAEI,eAAN,CAAsBC,yBAAzB,+DAAsD,CAA5E,CAEA,GAAIH,KAAJ,CAAW,CACTI,OAAO,CAACJ,KAAR,CAAc,8BAAd,EACA,mBACE,oBAAC,MAAD,mBACE,oBAAC,UAAD,MAAalB,CAAC,CAAC,qCAAD,CAAd,CADF,CADF,CAKD,CAED,mBACE,+BACGiB,OAAO,cACN,oBAAC,MAAD,mBACE,oBAAC,MAAD,MADF,CADM,CAIJE,gBAAgB,CAAG,CAAnB,cACF,oBAAC,uBAAD,EACE,OAAO,CAAEnB,CAAC,CACR,0DADQ,CADZ,CAIE,IAAI,cACF,oBAAC,IAAD,EACE,SAAS,CAAC,MADZ,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAE,kBAAM,CACbG,IAAI,CAACoB,mBAAL,CAAyB,CAAzB,EACA/B,OAAO,CAACgC,IAAR,CAAa,CACXC,QAAQ,CAAE,YADC,CAEXC,MAAM,sBAAgBzB,SAAhB,yBAAyCC,WAAzC,CAFK,CAAb,EAID,CATH,eAWE,oBAAC,UAAD,EAAY,SAAS,CAAEE,OAAO,CAACuB,WAA/B,EACG3B,CAAC,CAAC,0DAAD,CADJ,CAXF,CALJ,CAqBE,UAAU,CAAC,kBArBb,CAsBE,YAAY,CAAC,2BAtBf,CAuBE,YAAY,CAAC,UAvBf,CAwBE,UAAU,CAAEA,CAAC,CACX,2DADW,CAxBf,EA4BGgB,IA5BH,SA4BGA,IA5BH,iBA4BGA,IAAI,CAAEI,eAAN,CAAsBQ,aAAtB,CAAoCC,GAApC,CAAwC,SAACC,QAAD,CAAc,CACrD,mBACE,oBAAC,eAAD,EAAiB,GAAG,CAAEA,QAAQ,CAACC,WAA/B,CAA4C,IAAI,CAAED,QAAlD,EADF,CAGD,CAJA,CA5BH,CADE,cAoCF,oBAAC,iBAAD,EACE,GAAG,CAAC,kCADN,CAEE,GAAG,CAAC,qBAFN,CAGE,OAAO,CAAE9B,CAAC,CAAC,kDAAD,CAHZ,CAIE,WAAW,CAAEA,CAAC,CACZ,sDADY,CAJhB,CAOE,MAAM,cACJ,oBAAC,YAAD,EACE,OAAO,CAAE,kBAAM,CACbR,OAAO,CAACgC,IAAR,CAAa,CACXC,QAAQ,CAAE,kBADC,CAEXC,MAAM,sBAAgBzB,SAAhB,yBAAyCC,WAAzC,CAFK,CAAb,EAID,CANH,eAQE,oBAAC,UAAD,MACGF,CAAC,CAAC,mDAAD,CADJ,CARF,CARJ,CAqBE,IAAI,cACF,oBAAC,IAAD,EACE,SAAS,CAAC,MADZ,CAEE,KAAK,CAAC,SAFR,CAGE,OAAO,CAAE,kBAAM,CACbG,IAAI,CAACoB,mBAAL,CAAyB,CAAzB,EACA/B,OAAO,CAACgC,IAAR,CAAa,CACXC,QAAQ,CAAE,YADC,CAEXC,MAAM,sBAAgBzB,SAAhB,yBAAyCC,WAAzC,CAFK,CAAb,EAID,CATH,eAWE,oBAAC,UAAD,MACGF,CAAC,CAAC,kDAAD,CADJ,CAXF,CAtBJ,EAzCJ,cAmFE,oBAAC,iBAAD,EACE,KAAK,CAAED,UADT,CAEE,SAAS,CAAEC,CAAC,CAAC,wDAAD,CAFd,CAGE,WAAW,CAAEA,CAAC,CACZ,8DADY,CAHhB,CAME,QAAQ,CAAC,YANX,CAOE,MAAM,cACJ,qDACE,oBAAC,cAAD,EACE,OAAO,CAAEQ,UADX,CAEE,SAAS,CAAEJ,OAAO,CAAC4B,mBAFrB,eAIE,oBAAC,UAAD,mBACE,oBAAC,eAAD,MADF,CAEGhC,CAAC,CAAC,yDAAD,CAFJ,CAJF,CADF,cAWE,oBAAC,KAAD,EACE,MAAM,CAAC,KADT,CAEE,KAAK,CAAC,KAFR,CAGE,IAAI,CAAEK,SAHR,CAIE,OAAO,CAAEE,WAJX,CAKE,YAAY,cACV,oBAAC,cAAD,EAAgB,OAAO,CAAEA,WAAzB,WANJ,eASE,oBAAC,gBAAD,EAAkB,WAAW,CAAEA,WAA/B,EATF,CAXF,CARJ,EAnFF,CAsHGL,WAAW,GAAKb,IAAI,CAAC4C,KAArB,eAA8B,oBAAC,oBAAD,MAtHjC,CADF,CA0HD,CAxKD,CA0KA,OAASnC,mBAAT","sourcesContent":["import { useQuery } from '@apollo/client';\nimport { Link, Typography } from '@material-ui/core';\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\nimport { ButtonFilled, ButtonOutlined, Modal } from 'litmus-ui';\nimport React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { AgentDeployModal } from '../../../components/AgentDeployModal';\nimport Loader from '../../../components/Loader';\nimport { MainInfoContainer } from '../../../components/MainInfoContainer';\nimport { OverviewContainer } from '../../../components/OverviewContainer';\nimport { RecentOverviewContainer } from '../../../components/RecentOverviewContainer';\nimport Center from '../../../containers/layouts/Center';\nimport { WORKFLOW_DETAILS } from '../../../graphql';\nimport { Role } from '../../../models/graphql/user';\nimport {\n  Workflow,\n  WorkflowDataVars,\n} from '../../../models/graphql/workflowData';\nimport useActions from '../../../redux/actions';\nimport * as TabActions from '../../../redux/actions/tabs';\nimport { history } from '../../../redux/configureStore';\nimport { getProjectID, getProjectRole } from '../../../utils/getSearchParams';\nimport { ProjectInfoContainer } from '../ProjectInfoContainer';\nimport useStyles from './styles';\nimport { WorkflowRunCard } from './WorkflowRunCard';\n\ninterface AgentConfiguredHomeProps {\n  agentCount: number;\n}\n\nconst AgentConfiguredHome: React.FC<AgentConfiguredHomeProps> = ({\n  agentCount,\n}) => {\n  const { t } = useTranslation();\n  const projectID = getProjectID();\n  const projectRole = getProjectRole();\n  const tabs = useActions(TabActions);\n  const classes = useStyles();\n\n  const [modalOpen, setModalOpen] = useState<boolean>(false);\n\n  const handleClose = () => {\n    setModalOpen(false);\n  };\n\n  const handleOpen = () => {\n    setModalOpen(true);\n  };\n\n  const { data, loading, error } = useQuery<Workflow, WorkflowDataVars>(\n    WORKFLOW_DETAILS,\n    {\n      variables: {\n        workflowRunsInput: {\n          project_id: projectID,\n          pagination: {\n            page: 0,\n            limit: 3,\n          },\n        },\n      },\n      fetchPolicy: 'cache-and-network',\n    }\n  );\n\n  const workflowRunCount = data?.getWorkflowRuns.total_no_of_workflow_runs ?? 0;\n\n  if (error) {\n    console.error('Error fetching Workflow Data');\n    return (\n      <Center>\n        <Typography>{t('homeViews.agentConfiguredHome.error')}</Typography>\n      </Center>\n    );\n  }\n\n  return (\n    <div>\n      {loading ? (\n        <Center>\n          <Loader />\n        </Center>\n      ) : workflowRunCount > 0 ? (\n        <RecentOverviewContainer\n          heading={t(\n            'homeViews.agentConfiguredHome.recentWorkflowRuns.heading'\n          )}\n          link={\n            <Link\n              underline=\"none\"\n              color=\"primary\"\n              onClick={() => {\n                tabs.changeWorkflowsTabs(0);\n                history.push({\n                  pathname: '/workflows',\n                  search: `?projectID=${projectID}&projectRole=${projectRole}`,\n                });\n              }}\n            >\n              <Typography className={classes.linkPointer}>\n                {t('homeViews.agentConfiguredHome.recentWorkflowRuns.viewAll')}\n              </Typography>\n            </Link>\n          }\n          buttonLink=\"/create-workflow\"\n          buttonImgSrc=\"./icons/calendarBlank.svg\"\n          buttonImgAlt=\"calendar\"\n          buttonText={t(\n            'homeViews.agentConfiguredHome.recentWorkflowRuns.schedule'\n          )}\n        >\n          {data?.getWorkflowRuns.workflow_runs.map((workflow) => {\n            return (\n              <WorkflowRunCard key={workflow.workflow_id} data={workflow} />\n            );\n          })}\n        </RecentOverviewContainer>\n      ) : (\n        <MainInfoContainer\n          src=\"./icons/workflowScheduleHome.svg\"\n          alt=\"Schedule a workflow\"\n          heading={t('homeViews.agentConfiguredHome.noWorkflow.heading')}\n          description={t(\n            'homeViews.agentConfiguredHome.noWorkflow.description'\n          )}\n          button={\n            <ButtonFilled\n              onClick={() => {\n                history.push({\n                  pathname: '/create-workflow',\n                  search: `?projectID=${projectID}&projectRole=${projectRole}`,\n                });\n              }}\n            >\n              <Typography>\n                {t('homeViews.agentConfiguredHome.noWorkflow.schedule')}\n              </Typography>\n            </ButtonFilled>\n          }\n          link={\n            <Link\n              underline=\"none\"\n              color=\"primary\"\n              onClick={() => {\n                tabs.changeWorkflowsTabs(2);\n                history.push({\n                  pathname: '/workflows',\n                  search: `?projectID=${projectID}&projectRole=${projectRole}`,\n                });\n              }}\n            >\n              <Typography>\n                {t('homeViews.agentConfiguredHome.noWorkflow.explore')}\n              </Typography>\n            </Link>\n          }\n        />\n      )}\n\n      {/* Agent info container */}\n      <OverviewContainer\n        count={agentCount}\n        countUnit={t('homeViews.agentConfiguredHome.agentInfoContainer.agent')}\n        description={t(\n          'homeViews.agentConfiguredHome.agentInfoContainer.description'\n        )}\n        maxWidth=\"25.5625rem\"\n        button={\n          <>\n            <ButtonOutlined\n              onClick={handleOpen}\n              className={classes.infoContainerButton}\n            >\n              <Typography>\n                <ArrowUpwardIcon />\n                {t('homeViews.agentConfiguredHome.agentInfoContainer.deploy')}\n              </Typography>\n            </ButtonOutlined>\n\n            <Modal\n              height=\"50%\"\n              width=\"50%\"\n              open={modalOpen}\n              onClose={handleClose}\n              modalActions={\n                <ButtonOutlined onClick={handleClose}>&#x2715;</ButtonOutlined>\n              }\n            >\n              <AgentDeployModal handleClose={handleClose} />\n            </Modal>\n          </>\n        }\n      />\n\n      {/* Project Level info container */}\n      {projectRole === Role.owner && <ProjectInfoContainer />}\n    </div>\n  );\n};\n\nexport { AgentConfiguredHome };\n"]},"metadata":{},"sourceType":"module"}