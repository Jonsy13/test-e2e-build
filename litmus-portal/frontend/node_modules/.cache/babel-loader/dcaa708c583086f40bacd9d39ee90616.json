{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useMutation,useQuery}from'@apollo/client';import{Avatar,IconButton,Menu,MenuItem,TableCell,Typography}from'@material-ui/core';import{ButtonFilled,LightPills}from'litmus-ui';import React,{useState}from'react';import{useTranslation}from'react-i18next';import{ALL_USERS,GET_PROJECT,GET_USER,SEND_INVITE}from'../../../../graphql';import{InvitationStatus}from'../../../../models/graphql/invite';import{Role}from'../../../../models/graphql/user';import{getProjectID}from'../../../../utils/getSearchParams';import{userInitials}from'../../../../utils/userInitials';import RemoveMemberModal from'./removeMemberModal';import useStyles from'./styles';var InvitedTableData=function InvitedTableData(_ref){var row=_ref.row,showModal=_ref.showModal;var classes=useStyles();var projectID=getProjectID();var _useTranslation=useTranslation(),t=_useTranslation.t;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(row.role),_useState4=_slicedToArray(_useState3,2),role=_useState4[0],setRole=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),anchorEl=_useState6[0],setAnchorEl=_useState6[1];var handleClose=function handleClose(){setAnchorEl(null);};var _useMutation=useMutation(SEND_INVITE,{onCompleted:function onCompleted(){window.location.reload();},refetchQueries:[{query:GET_PROJECT,variables:{projectID:projectID}},{query:ALL_USERS}]}),_useMutation2=_slicedToArray(_useMutation,1),SendInvite=_useMutation2[0];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),memberDetails=_useState8[0],setMemberDetails=_useState8[1];// Query to get user details\nuseQuery(GET_USER,{variables:{username:row.user_name},onCompleted:function onCompleted(data){setMemberDetails({// TODO: Check if all are being used\nname:data.getUser.name,uid:data.getUser.id,username:data.getUser.username,role:data.getUser.role,email:data.getUser.email});}});return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(TableCell,{className:classes.firstTC,component:\"th\",scope:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:classes.firstCol},/*#__PURE__*/React.createElement(Avatar,{\"data-cy\":\"avatar\",alt:\"User\",className:classes.avatarBackground},userInitials(memberDetails?memberDetails.username:'')),memberDetails?memberDetails.username:'')),/*#__PURE__*/React.createElement(TableCell,{className:classes.otherTC},/*#__PURE__*/React.createElement(\"div\",{className:classes.dropDown},role,/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"more\",\"aria-controls\":\"long-menu\",\"aria-haspopup\":\"true\",onClick:function onClick(event){setAnchorEl(event.currentTarget);},className:classes.optionBtn},/*#__PURE__*/React.createElement(\"img\",{src:\"./icons/down-arrow.svg\",alt:\"more\"})),/*#__PURE__*/React.createElement(Menu,{keepMounted:true,open:Boolean(anchorEl),id:\"long-menu\",anchorEl:anchorEl,onClose:handleClose},/*#__PURE__*/React.createElement(MenuItem,{onClick:function onClick(){setRole(Role.editor);setAnchorEl(null);},className:classes.menuOpt},/*#__PURE__*/React.createElement(\"div\",{className:classes.menuDiv},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{className:classes.menuHeader},/*#__PURE__*/React.createElement(\"strong\",null,t('settings.teamingTab.invitation.sentInvitation.menuItem.editorRole.label')))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{className:classes.menuDesc},t('settings.teamingTab.invitation.sentInvitation.menuItem.editorRole.body'))))),/*#__PURE__*/React.createElement(MenuItem,{onClick:function onClick(){setRole(Role.viewer);setAnchorEl(null);},className:classes.menuOpt},/*#__PURE__*/React.createElement(\"div\",{className:classes.menuDiv},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{className:classes.menuHeader},/*#__PURE__*/React.createElement(\"strong\",null,t('settings.teamingTab.invitation.sentInvitation.menuItem.viewerRole.label')))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{className:classes.menuDesc},t('settings.teamingTab.invitation.sentInvitation.menuItem.viewerRole.body')))))))),/*#__PURE__*/React.createElement(TableCell,{className:classes.otherTC},memberDetails?memberDetails.email:''),/*#__PURE__*/React.createElement(TableCell,{className:classes.otherTC},/*#__PURE__*/React.createElement(LightPills,{variant:row.invitation===InvitationStatus.pending?'warning':'danger',label:row.invitation})),/*#__PURE__*/React.createElement(TableCell,{className:classes.buttonTC,key:row.user_id},/*#__PURE__*/React.createElement(\"div\",{className:classes.lastCell},row.invitation!==InvitationStatus.exited&&row.invitation!==InvitationStatus.declined&&/*#__PURE__*/React.createElement(IconButton,{onClick:function onClick(){return setOpen(true);}},/*#__PURE__*/React.createElement(\"img\",{alt:\"delete\",src:\"./icons/deleteBox.svg\",height:\"45\"})),/*#__PURE__*/React.createElement(ButtonFilled,{disabled:false,onClick:function onClick(){SendInvite({variables:{member:{project_id:projectID,user_id:row.user_id,role:role}}});}},t('settings.teamingTab.invitation.sentInvitation.resend')))),open&&/*#__PURE__*/React.createElement(RemoveMemberModal,{open:open,handleClose:function handleClose(){setOpen(false);},row:row,showModal:showModal,isRemove:false}));};export default InvitedTableData;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Settings/TeamingTab/Team/invitedTableData.tsx"],"names":["useMutation","useQuery","Avatar","IconButton","Menu","MenuItem","TableCell","Typography","ButtonFilled","LightPills","React","useState","useTranslation","ALL_USERS","GET_PROJECT","GET_USER","SEND_INVITE","InvitationStatus","Role","getProjectID","userInitials","RemoveMemberModal","useStyles","InvitedTableData","row","showModal","classes","projectID","t","open","setOpen","role","setRole","anchorEl","setAnchorEl","handleClose","onCompleted","window","location","reload","refetchQueries","query","variables","SendInvite","memberDetails","setMemberDetails","username","user_name","data","name","getUser","uid","id","email","firstTC","firstCol","avatarBackground","otherTC","dropDown","event","currentTarget","optionBtn","Boolean","editor","menuOpt","menuDiv","menuHeader","menuDesc","viewer","invitation","pending","buttonTC","user_id","lastCell","exited","declined","member","project_id"],"mappings":"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","sourcesContent":["import { useMutation, useQuery } from '@apollo/client';\nimport {\n  Avatar,\n  IconButton,\n  Menu,\n  MenuItem,\n  TableCell,\n  Typography,\n} from '@material-ui/core';\nimport { ButtonFilled, LightPills } from 'litmus-ui';\nimport React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  ALL_USERS,\n  GET_PROJECT,\n  GET_USER,\n  SEND_INVITE,\n} from '../../../../graphql';\nimport {\n  InvitationStatus,\n  MemberInviteNew,\n} from '../../../../models/graphql/invite';\nimport {\n  CurrentUserDedtailsVars,\n  CurrentUserDetails,\n  Member,\n  Role,\n} from '../../../../models/graphql/user';\nimport { CurrentUserData } from '../../../../models/userData';\nimport { getProjectID } from '../../../../utils/getSearchParams';\nimport { userInitials } from '../../../../utils/userInitials';\nimport RemoveMemberModal from './removeMemberModal';\nimport useStyles from './styles';\n\ninterface TableDataProps {\n  row: Member;\n  index: number;\n  showModal: () => void;\n}\nconst InvitedTableData: React.FC<TableDataProps> = ({ row, showModal }) => {\n  const classes = useStyles();\n  const projectID = getProjectID();\n\n  const { t } = useTranslation();\n  const [open, setOpen] = useState<boolean>(false);\n  const [role, setRole] = useState<string>(row.role);\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const [SendInvite] = useMutation<MemberInviteNew>(SEND_INVITE, {\n    onCompleted: () => {\n      window.location.reload();\n    },\n    refetchQueries: [\n      {\n        query: GET_PROJECT,\n        variables: { projectID },\n      },\n      {\n        query: ALL_USERS,\n      },\n    ],\n  });\n\n  const [memberDetails, setMemberDetails] = useState<CurrentUserData>();\n\n  // Query to get user details\n  useQuery<CurrentUserDetails, CurrentUserDedtailsVars>(GET_USER, {\n    variables: { username: row.user_name },\n    onCompleted: (data) => {\n      setMemberDetails({\n        // TODO: Check if all are being used\n        name: data.getUser.name,\n        uid: data.getUser.id,\n        username: data.getUser.username,\n        role: data.getUser.role,\n        email: data.getUser.email,\n      });\n    },\n  });\n  return (\n    <>\n      <TableCell className={classes.firstTC} component=\"th\" scope=\"row\">\n        <div className={classes.firstCol}>\n          <Avatar\n            data-cy=\"avatar\"\n            alt=\"User\"\n            className={classes.avatarBackground}\n          >\n            {userInitials(memberDetails ? memberDetails.username : '')}\n          </Avatar>\n          {memberDetails ? memberDetails.username : ''}\n        </div>\n      </TableCell>\n      <TableCell className={classes.otherTC}>\n        <div className={classes.dropDown}>\n          {role}\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"long-menu\"\n            aria-haspopup=\"true\"\n            onClick={(event) => {\n              setAnchorEl(event.currentTarget);\n            }}\n            className={classes.optionBtn}\n          >\n            <img src=\"./icons/down-arrow.svg\" alt=\"more\" />\n          </IconButton>\n          <Menu\n            keepMounted\n            open={Boolean(anchorEl)}\n            id=\"long-menu\"\n            anchorEl={anchorEl}\n            onClose={handleClose}\n          >\n            <MenuItem\n              onClick={() => {\n                setRole(Role.editor);\n                setAnchorEl(null);\n              }}\n              className={classes.menuOpt}\n            >\n              <div className={classes.menuDiv}>\n                <div>\n                  <Typography className={classes.menuHeader}>\n                    <strong>\n                      {t(\n                        'settings.teamingTab.invitation.sentInvitation.menuItem.editorRole.label'\n                      )}\n                    </strong>\n                  </Typography>\n                </div>\n                <div>\n                  <Typography className={classes.menuDesc}>\n                    {t(\n                      'settings.teamingTab.invitation.sentInvitation.menuItem.editorRole.body'\n                    )}\n                  </Typography>\n                </div>\n              </div>\n            </MenuItem>\n            <MenuItem\n              onClick={() => {\n                setRole(Role.viewer);\n                setAnchorEl(null);\n              }}\n              className={classes.menuOpt}\n            >\n              <div className={classes.menuDiv}>\n                <div>\n                  <Typography className={classes.menuHeader}>\n                    <strong>\n                      {t(\n                        'settings.teamingTab.invitation.sentInvitation.menuItem.viewerRole.label'\n                      )}\n                    </strong>\n                  </Typography>\n                </div>\n                <div>\n                  <Typography className={classes.menuDesc}>\n                    {t(\n                      'settings.teamingTab.invitation.sentInvitation.menuItem.viewerRole.body'\n                    )}\n                  </Typography>\n                </div>\n              </div>\n            </MenuItem>\n          </Menu>\n        </div>\n      </TableCell>\n      <TableCell className={classes.otherTC}>\n        {memberDetails ? memberDetails.email : ''}\n      </TableCell>\n      <TableCell className={classes.otherTC}>\n        <LightPills\n          variant={\n            row.invitation === InvitationStatus.pending ? 'warning' : 'danger'\n          }\n          label={row.invitation}\n        />\n      </TableCell>\n\n      <TableCell className={classes.buttonTC} key={row.user_id}>\n        <div className={classes.lastCell}>\n          {row.invitation !== InvitationStatus.exited &&\n            row.invitation !== InvitationStatus.declined && (\n              <IconButton onClick={() => setOpen(true)}>\n                <img alt=\"delete\" src=\"./icons/deleteBox.svg\" height=\"45\" />\n              </IconButton>\n            )}\n          <ButtonFilled\n            disabled={false}\n            onClick={() => {\n              SendInvite({\n                variables: {\n                  member: {\n                    project_id: projectID,\n                    user_id: row.user_id,\n                    role,\n                  },\n                },\n              });\n            }}\n          >\n            {t('settings.teamingTab.invitation.sentInvitation.resend')}\n          </ButtonFilled>\n        </div>\n      </TableCell>\n      {open && (\n        <RemoveMemberModal\n          open={open}\n          handleClose={() => {\n            setOpen(false);\n          }}\n          row={row}\n          showModal={showModal}\n          isRemove={false}\n        />\n      )}\n    </>\n  );\n};\nexport default InvitedTableData;\n"]},"metadata":{},"sourceType":"module"}