{"ast":null,"code":"import _regeneratorRuntime from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useMutation}from'@apollo/client';import{IconButton,Menu,MenuItem,Typography}from'@material-ui/core';import MoreVertIcon from'@material-ui/icons/MoreVert';import{ButtonFilled,ButtonOutlined,Modal}from'litmus-ui';import moment from'moment';import React,{useEffect}from'react';import{useTranslation}from'react-i18next';import{DELETE_DASHBOARD}from'../../../../graphql/mutations';import useActions from'../../../../redux/actions';import*as DashboardActions from'../../../../redux/actions/dashboards';import*as DataSourceActions from'../../../../redux/actions/dataSource';import*as TabActions from'../../../../redux/actions/tabs';import{history}from'../../../../redux/configureStore';import{ReactComponent as CrossMarkIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../../svg/crossmark.svg\";import{getProjectID,getProjectRole}from'../../../../utils/getSearchParams';import useStyles,{StyledTableCell}from'./styles';var TableData=function TableData(_ref){var data=_ref.data;var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var dashboard=useActions(DashboardActions);var dataSource=useActions(DataSourceActions);var tabs=useActions(TabActions);var projectID=getProjectID();var projectRole=getProjectRole();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),mutate=_React$useState2[0],setMutate=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),confirm=_React$useState4[0],setConfirm=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),success=_React$useState6[0],setSuccess=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),openModal=_React$useState8[0],setOpenModal=_React$useState8[1];var _React$useState9=React.useState({dbID:''}),_React$useState10=_slicedToArray(_React$useState9,2),dashboardSelectedForDeleting=_React$useState10[0],setDashboardSelectedForDeleting=_React$useState10[1];var _useMutation=useMutation(DELETE_DASHBOARD,{onCompleted:function onCompleted(){setSuccess(true);setMutate(false);setOpenModal(true);},onError:function onError(){setMutate(false);setOpenModal(true);}}),_useMutation2=_slicedToArray(_useMutation,1),deleteDashboard=_useMutation2[0];// Function to convert UNIX time in format of dddd, DD MMM YYYY, HH:mm\nvar formatDate=function formatDate(date){var updated=new Date(parseInt(date,10)*1000).toString();var resDate=moment(updated).format('dddd, DD MMM YYYY, HH:mm');return resDate;};var _React$useState11=React.useState(null),_React$useState12=_slicedToArray(_React$useState11,2),anchorEl=_React$useState12[0],setAnchorEl=_React$useState12[1];var open=Boolean(anchorEl);var handleClick=function handleClick(event){setAnchorEl(event.currentTarget);};var handleClose=function handleClose(){setAnchorEl(null);};var onDashboardLoadRoutine=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dashboard.selectDashboard({selectedDashboardID:data.db_id,refreshRate:0});dataSource.selectDataSource({selectedDataSourceURL:'',selectedDataSourceID:'',selectedDataSourceName:''});return _context.abrupt(\"return\",true);case 3:case\"end\":return _context.stop();}}},_callee);}));return function onDashboardLoadRoutine(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(mutate===true){deleteDashboard({variables:{dbID:dashboardSelectedForDeleting.dbID}});}},[mutate]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(StyledTableCell,{className:classes.dashboardName},/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",align:\"center\",className:classes.tableData},/*#__PURE__*/React.createElement(\"strong\",null,data.db_name))),/*#__PURE__*/React.createElement(StyledTableCell,{className:classes.tableHeader},/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",align:\"center\",className:classes.tableData},/*#__PURE__*/React.createElement(\"strong\",null,data.cluster_name))),/*#__PURE__*/React.createElement(StyledTableCell,{className:classes.tableHeader},/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",align:\"center\"},/*#__PURE__*/React.createElement(\"strong\",null,data.db_type_name))),/*#__PURE__*/React.createElement(StyledTableCell,{className:classes.tableHeader},/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",align:\"center\"},/*#__PURE__*/React.createElement(\"strong\",null,data.ds_type))),/*#__PURE__*/React.createElement(StyledTableCell,{className:classes.tableHeader},/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",align:\"center\"},formatDate(data.updated_at))),/*#__PURE__*/React.createElement(StyledTableCell,null,/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"more\",\"aria-controls\":\"long-menu\",\"aria-haspopup\":\"true\",onClick:handleClick,\"data-cy\":\"browseDashboardOptions\"},/*#__PURE__*/React.createElement(MoreVertIcon,{className:classes.headerIcon})),/*#__PURE__*/React.createElement(Menu,{id:\"long-menu\",anchorEl:anchorEl,keepMounted:true,open:open,onClose:handleClose},/*#__PURE__*/React.createElement(MenuItem,{value:\"Analysis\",onClick:function onClick(){onDashboardLoadRoutine().then(function(){history.push({pathname:'/analytics/application-dashboard',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});});},className:classes.menuItem},/*#__PURE__*/React.createElement(\"div\",{className:classes.expDiv},/*#__PURE__*/React.createElement(\"img\",{src:\"/icons/analytics.svg\",alt:\"See Analytics\",className:classes.btnImg}),/*#__PURE__*/React.createElement(Typography,{\"data-cy\":\"openDashboard\",className:classes.btnText},t('analyticsDashboardViews.kubernetesDashboard.table.seeAnalytics')))),/*#__PURE__*/React.createElement(MenuItem,{value:\"Configure\",onClick:function onClick(){dashboard.selectDashboard({selectedDashboardID:data.db_id,activePanelID:''});history.push({pathname:'/analytics/dashboard/configure',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});},className:classes.menuItem},/*#__PURE__*/React.createElement(\"div\",{className:classes.expDiv},/*#__PURE__*/React.createElement(\"img\",{src:\"/icons/cogwheel.svg\",alt:\"Configure\",className:classes.btnImg}),/*#__PURE__*/React.createElement(Typography,{\"data-cy\":\" configureDashboard\",className:classes.btnText},t('analyticsDashboardViews.kubernetesDashboard.table.configure')))),/*#__PURE__*/React.createElement(MenuItem,{value:\"Delete\",onClick:function onClick(){setDashboardSelectedForDeleting({dbID:data.db_id});setOpenModal(true);},className:classes.menuItem},/*#__PURE__*/React.createElement(\"div\",{className:classes.expDiv},/*#__PURE__*/React.createElement(\"img\",{src:\"/icons/delete.svg\",alt:\"Delete\",className:classes.btnImg}),/*#__PURE__*/React.createElement(Typography,{\"data-cy\":\"deleteDashboard\",className:classes.btnText},\"Delete\"))))),/*#__PURE__*/React.createElement(Modal,{open:openModal,onClose:function onClose(){setConfirm(false);setOpenModal(false);},width:\"60%\",modalActions:/*#__PURE__*/React.createElement(ButtonOutlined,{className:classes.closeButton,onClick:function onClick(){setConfirm(false);setOpenModal(false);}},\"\\u2715\")},/*#__PURE__*/React.createElement(\"div\",{className:classes.modal},confirm===true?/*#__PURE__*/React.createElement(Typography,{align:\"center\"},success===true?/*#__PURE__*/React.createElement(\"img\",{src:\"/icons/finish.svg\",alt:\"success\",className:classes.icon}):/*#__PURE__*/React.createElement(CrossMarkIcon,{className:classes.icon})):/*#__PURE__*/React.createElement(\"div\",null),confirm===true?/*#__PURE__*/React.createElement(Typography,{className:classes.modalHeading,align:\"center\",variant:\"h3\"},success===true?\"The dashboard is successfully deleted.\":\"There was a problem deleting your dashboard.\"):/*#__PURE__*/React.createElement(\"div\",null),confirm===true?/*#__PURE__*/React.createElement(Typography,{align:\"center\",variant:\"body1\",className:classes.modalBody},success===true?/*#__PURE__*/React.createElement(\"div\",null,\"You will see the dashboard deleted in the dashboard table.\"):/*#__PURE__*/React.createElement(\"div\",null,\"Error encountered while deleting the dashboard. Please try again.\")):/*#__PURE__*/React.createElement(\"div\",null),success===true&&confirm===true?/*#__PURE__*/React.createElement(ButtonFilled,{variant:\"success\",onClick:function onClick(){setConfirm(false);setOpenModal(false);tabs.changeAnalyticsDashboardTabs(2);window.location.reload();}},/*#__PURE__*/React.createElement(\"div\",null,\"Back to Kubernetes Dashboard\")):success===false&&confirm===true?/*#__PURE__*/React.createElement(\"div\",{className:classes.flexButtons},/*#__PURE__*/React.createElement(ButtonOutlined,{className:classes.buttonOutlineWarning,onClick:function onClick(){setOpenModal(false);setMutate(true);},disabled:false},/*#__PURE__*/React.createElement(\"div\",null,\"Try Again\")),/*#__PURE__*/React.createElement(ButtonFilled,{variant:\"success\",onClick:function onClick(){setConfirm(false);setOpenModal(false);tabs.changeAnalyticsDashboardTabs(2);window.location.reload();}},/*#__PURE__*/React.createElement(\"div\",null,\"Back to Kubernetes Dashboard\"))):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{align:\"center\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/icons/delete_large_icon.svg\",alt:\"delete\",className:classes.icon})),/*#__PURE__*/React.createElement(Typography,{className:classes.modalHeading,align:\"center\",variant:\"h3\"},\"Are you sure to remove this dashboard?\"),/*#__PURE__*/React.createElement(Typography,{align:\"center\",variant:\"body1\",className:classes.modalBody},\"The following action cannot be reverted.\"),/*#__PURE__*/React.createElement(\"div\",{className:classes.flexButtons},/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:function onClick(){setOpenModal(false);history.push({pathname:'/analytics',search:\"?projectID=\".concat(projectID,\"&projectRole=\").concat(projectRole)});},disabled:false},/*#__PURE__*/React.createElement(\"div\",null,\"No\")),/*#__PURE__*/React.createElement(ButtonFilled,{variant:\"error\",onClick:function onClick(){setConfirm(true);setOpenModal(false);setMutate(true);}},/*#__PURE__*/React.createElement(\"div\",null,\"Yes\")))))));};export default TableData;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Analytics/ApplicationDashboards/Table/TableData.tsx"],"names":["useMutation","IconButton","Menu","MenuItem","Typography","MoreVertIcon","ButtonFilled","ButtonOutlined","Modal","moment","React","useEffect","useTranslation","DELETE_DASHBOARD","useActions","DashboardActions","DataSourceActions","TabActions","history","getProjectID","getProjectRole","useStyles","StyledTableCell","TableData","data","classes","t","dashboard","dataSource","tabs","projectID","projectRole","useState","mutate","setMutate","confirm","setConfirm","success","setSuccess","openModal","setOpenModal","dbID","dashboardSelectedForDeleting","setDashboardSelectedForDeleting","onCompleted","onError","deleteDashboard","formatDate","date","updated","Date","parseInt","toString","resDate","format","anchorEl","setAnchorEl","open","Boolean","handleClick","event","currentTarget","handleClose","onDashboardLoadRoutine","selectDashboard","selectedDashboardID","db_id","refreshRate","selectDataSource","selectedDataSourceURL","selectedDataSourceID","selectedDataSourceName","variables","dashboardName","tableData","db_name","tableHeader","cluster_name","db_type_name","ds_type","updated_at","headerIcon","then","push","pathname","search","menuItem","expDiv","btnImg","btnText","activePanelID","closeButton","modal","icon","modalHeading","modalBody","changeAnalyticsDashboardTabs","window","location","reload","flexButtons","buttonOutlineWarning"],"mappings":"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","sourcesContent":["import { useMutation } from '@apollo/client';\nimport { IconButton, Menu, MenuItem, Typography } from '@material-ui/core';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport { ButtonFilled, ButtonOutlined, Modal } from 'litmus-ui';\nimport moment from 'moment';\nimport React, { useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { DELETE_DASHBOARD } from '../../../../graphql/mutations';\nimport {\n  DeleteDashboardInput,\n  ListDashboardResponse,\n} from '../../../../models/graphql/dashboardsDetails';\nimport useActions from '../../../../redux/actions';\nimport * as DashboardActions from '../../../../redux/actions/dashboards';\nimport * as DataSourceActions from '../../../../redux/actions/dataSource';\nimport * as TabActions from '../../../../redux/actions/tabs';\nimport { history } from '../../../../redux/configureStore';\nimport { ReactComponent as CrossMarkIcon } from '../../../../svg/crossmark.svg';\nimport {\n  getProjectID,\n  getProjectRole,\n} from '../../../../utils/getSearchParams';\nimport useStyles, { StyledTableCell } from './styles';\n\ninterface TableDataProps {\n  data: ListDashboardResponse;\n}\n\nconst TableData: React.FC<TableDataProps> = ({ data }) => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const dashboard = useActions(DashboardActions);\n  const dataSource = useActions(DataSourceActions);\n  const tabs = useActions(TabActions);\n  const projectID = getProjectID();\n  const projectRole = getProjectRole();\n  const [mutate, setMutate] = React.useState(false);\n  const [confirm, setConfirm] = React.useState(false);\n  const [success, setSuccess] = React.useState(false);\n  const [openModal, setOpenModal] = React.useState(false);\n  const [dashboardSelectedForDeleting, setDashboardSelectedForDeleting] =\n    React.useState<DeleteDashboardInput>({\n      dbID: '',\n    });\n\n  const [deleteDashboard] = useMutation<boolean, DeleteDashboardInput>(\n    DELETE_DASHBOARD,\n    {\n      onCompleted: () => {\n        setSuccess(true);\n        setMutate(false);\n        setOpenModal(true);\n      },\n      onError: () => {\n        setMutate(false);\n        setOpenModal(true);\n      },\n    }\n  );\n\n  // Function to convert UNIX time in format of dddd, DD MMM YYYY, HH:mm\n  const formatDate = (date: string) => {\n    const updated = new Date(parseInt(date, 10) * 1000).toString();\n    const resDate = moment(updated).format('dddd, DD MMM YYYY, HH:mm');\n    return resDate;\n  };\n\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const open = Boolean(anchorEl);\n\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const onDashboardLoadRoutine = async () => {\n    dashboard.selectDashboard({\n      selectedDashboardID: data.db_id,\n      refreshRate: 0,\n    });\n    dataSource.selectDataSource({\n      selectedDataSourceURL: '',\n      selectedDataSourceID: '',\n      selectedDataSourceName: '',\n    });\n    return true;\n  };\n\n  useEffect(() => {\n    if (mutate === true) {\n      deleteDashboard({\n        variables: { dbID: dashboardSelectedForDeleting.dbID },\n      });\n    }\n  }, [mutate]);\n\n  return (\n    <>\n      <StyledTableCell className={classes.dashboardName}>\n        <Typography\n          variant=\"body2\"\n          align=\"center\"\n          className={classes.tableData}\n        >\n          <strong>{data.db_name}</strong>\n        </Typography>\n      </StyledTableCell>\n\n      <StyledTableCell className={classes.tableHeader}>\n        <Typography\n          variant=\"body2\"\n          align=\"center\"\n          className={classes.tableData}\n        >\n          <strong>{data.cluster_name}</strong>\n        </Typography>\n      </StyledTableCell>\n\n      <StyledTableCell className={classes.tableHeader}>\n        <Typography variant=\"body2\" align=\"center\">\n          <strong>{data.db_type_name}</strong>\n        </Typography>\n      </StyledTableCell>\n\n      <StyledTableCell className={classes.tableHeader}>\n        <Typography variant=\"body2\" align=\"center\">\n          <strong>{data.ds_type}</strong>\n        </Typography>\n      </StyledTableCell>\n\n      <StyledTableCell className={classes.tableHeader}>\n        <Typography variant=\"body2\" align=\"center\">\n          {formatDate(data.updated_at)}\n        </Typography>\n      </StyledTableCell>\n\n      <StyledTableCell>\n        <IconButton\n          aria-label=\"more\"\n          aria-controls=\"long-menu\"\n          aria-haspopup=\"true\"\n          onClick={handleClick}\n          data-cy=\"browseDashboardOptions\"\n        >\n          <MoreVertIcon className={classes.headerIcon} />\n        </IconButton>\n        <Menu\n          id=\"long-menu\"\n          anchorEl={anchorEl}\n          keepMounted\n          open={open}\n          onClose={handleClose}\n        >\n          <MenuItem\n            value=\"Analysis\"\n            onClick={() => {\n              onDashboardLoadRoutine().then(() => {\n                history.push({\n                  pathname: '/analytics/application-dashboard',\n                  search: `?projectID=${projectID}&projectRole=${projectRole}`,\n                });\n              });\n            }}\n            className={classes.menuItem}\n          >\n            <div className={classes.expDiv}>\n              <img\n                src=\"/icons/analytics.svg\"\n                alt=\"See Analytics\"\n                className={classes.btnImg}\n              />\n              <Typography data-cy=\"openDashboard\" className={classes.btnText}>\n                {t(\n                  'analyticsDashboardViews.kubernetesDashboard.table.seeAnalytics'\n                )}\n              </Typography>\n            </div>\n          </MenuItem>\n\n          <MenuItem\n            value=\"Configure\"\n            onClick={() => {\n              dashboard.selectDashboard({\n                selectedDashboardID: data.db_id,\n                activePanelID: '',\n              });\n              history.push({\n                pathname: '/analytics/dashboard/configure',\n                search: `?projectID=${projectID}&projectRole=${projectRole}`,\n              });\n            }}\n            className={classes.menuItem}\n          >\n            <div className={classes.expDiv}>\n              <img\n                src=\"/icons/cogwheel.svg\"\n                alt=\"Configure\"\n                className={classes.btnImg}\n              />\n              <Typography\n                data-cy=\" configureDashboard\"\n                className={classes.btnText}\n              >\n                {t(\n                  'analyticsDashboardViews.kubernetesDashboard.table.configure'\n                )}\n              </Typography>\n            </div>\n          </MenuItem>\n\n          <MenuItem\n            value=\"Delete\"\n            onClick={() => {\n              setDashboardSelectedForDeleting({\n                dbID: data.db_id,\n              });\n              setOpenModal(true);\n            }}\n            className={classes.menuItem}\n          >\n            <div className={classes.expDiv}>\n              <img\n                src=\"/icons/delete.svg\"\n                alt=\"Delete\"\n                className={classes.btnImg}\n              />\n              <Typography data-cy=\"deleteDashboard\" className={classes.btnText}>\n                Delete\n              </Typography>\n            </div>\n          </MenuItem>\n        </Menu>\n      </StyledTableCell>\n\n      <Modal\n        open={openModal}\n        onClose={() => {\n          setConfirm(false);\n          setOpenModal(false);\n        }}\n        width=\"60%\"\n        modalActions={\n          <ButtonOutlined\n            className={classes.closeButton}\n            onClick={() => {\n              setConfirm(false);\n              setOpenModal(false);\n            }}\n          >\n            &#x2715;\n          </ButtonOutlined>\n        }\n      >\n        <div className={classes.modal}>\n          {confirm === true ? (\n            <Typography align=\"center\">\n              {success === true ? (\n                <img\n                  src=\"/icons/finish.svg\"\n                  alt=\"success\"\n                  className={classes.icon}\n                />\n              ) : (\n                <CrossMarkIcon className={classes.icon} />\n              )}\n            </Typography>\n          ) : (\n            <div />\n          )}\n\n          {confirm === true ? (\n            <Typography\n              className={classes.modalHeading}\n              align=\"center\"\n              variant=\"h3\"\n            >\n              {success === true\n                ? `The dashboard is successfully deleted.`\n                : `There was a problem deleting your dashboard.`}\n            </Typography>\n          ) : (\n            <div />\n          )}\n\n          {confirm === true ? (\n            <Typography\n              align=\"center\"\n              variant=\"body1\"\n              className={classes.modalBody}\n            >\n              {success === true ? (\n                <div>\n                  You will see the dashboard deleted in the dashboard table.\n                </div>\n              ) : (\n                <div>\n                  Error encountered while deleting the dashboard. Please try\n                  again.\n                </div>\n              )}\n            </Typography>\n          ) : (\n            <div />\n          )}\n\n          {success === true && confirm === true ? (\n            <ButtonFilled\n              variant=\"success\"\n              onClick={() => {\n                setConfirm(false);\n                setOpenModal(false);\n                tabs.changeAnalyticsDashboardTabs(2);\n                window.location.reload();\n              }}\n            >\n              <div>Back to Kubernetes Dashboard</div>\n            </ButtonFilled>\n          ) : success === false && confirm === true ? (\n            <div className={classes.flexButtons}>\n              <ButtonOutlined\n                className={classes.buttonOutlineWarning}\n                onClick={() => {\n                  setOpenModal(false);\n                  setMutate(true);\n                }}\n                disabled={false}\n              >\n                <div>Try Again</div>\n              </ButtonOutlined>\n\n              <ButtonFilled\n                variant=\"success\"\n                onClick={() => {\n                  setConfirm(false);\n                  setOpenModal(false);\n                  tabs.changeAnalyticsDashboardTabs(2);\n                  window.location.reload();\n                }}\n              >\n                <div>Back to Kubernetes Dashboard</div>\n              </ButtonFilled>\n            </div>\n          ) : (\n            <div>\n              <Typography align=\"center\">\n                <img\n                  src=\"/icons/delete_large_icon.svg\"\n                  alt=\"delete\"\n                  className={classes.icon}\n                />\n              </Typography>\n\n              <Typography\n                className={classes.modalHeading}\n                align=\"center\"\n                variant=\"h3\"\n              >\n                Are you sure to remove this dashboard?\n              </Typography>\n\n              <Typography\n                align=\"center\"\n                variant=\"body1\"\n                className={classes.modalBody}\n              >\n                The following action cannot be reverted.\n              </Typography>\n\n              <div className={classes.flexButtons}>\n                <ButtonOutlined\n                  onClick={() => {\n                    setOpenModal(false);\n                    history.push({\n                      pathname: '/analytics',\n                      search: `?projectID=${projectID}&projectRole=${projectRole}`,\n                    });\n                  }}\n                  disabled={false}\n                >\n                  <div>No</div>\n                </ButtonOutlined>\n\n                <ButtonFilled\n                  variant=\"error\"\n                  onClick={() => {\n                    setConfirm(true);\n                    setOpenModal(false);\n                    setMutate(true);\n                  }}\n                >\n                  <div>Yes</div>\n                </ButtonFilled>\n              </div>\n            </div>\n          )}\n        </div>\n      </Modal>\n    </>\n  );\n};\nexport default TableData;\n"]},"metadata":{},"sourceType":"module"}