{"ast":null,"code":"import _defineProperty from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Modal,ButtonOutlined,ButtonFilled,InputField}from'litmus-ui';import{MenuItem,Select,InputLabel}from'@material-ui/core';import{useTranslation}from'react-i18next';import React from'react';import useStyles from'./styles';import ProbeDetails from'./ProbeDetails';import{validateProbeName}from'../../../../utils/validate';var AddProbe=function AddProbe(_ref){var probesValue=_ref.probesValue,addProbe=_ref.addProbe,handleClose=_ref.handleClose,open=_ref.open;var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var _React$useState=React.useState(probesValue&&probesValue.length?probesValue:[]),_React$useState2=_slicedToArray(_React$useState,2),allProbes=_React$useState2[0],setAllProbes=_React$useState2[1];var _React$useState3=React.useState('httpProbe/inputs'),_React$useState4=_slicedToArray(_React$useState3,2),probeType=_React$useState4[0],setProbeType=_React$useState4[1];var _React$useState5=React.useState({probeTimeout:'',retry:'',interval:'',probePollingInterval:'',initialDelaySeconds:''}),_React$useState6=_slicedToArray(_React$useState5,2),runProperties=_React$useState6[0],setRunProperties=_React$useState6[1];var _React$useState7=React.useState({name:'',type:'httpProbe',mode:'Continuous',runProperties:{},'httpProbe/inputs':{}}),_React$useState8=_slicedToArray(_React$useState7,2),probeData=_React$useState8[0],setProbeData=_React$useState8[1];var handleRunProps=function handleRunProps(e){setRunProperties(_objectSpread(_objectSpread({},runProperties),{},_defineProperty({},e.target.name,parseInt(e.target.value,10))));};var renameKey=function renameKey(object,key,newKey){var clonedObj=_objectSpread({},object);var targetKey=clonedObj[key];delete clonedObj[key];clonedObj[newKey]=targetKey;return clonedObj;};var onTypeChange=function onTypeChange(e){var newProbe=\"\".concat(e.target.value,\"/inputs\");var a=renameKey(probeData,probeType,newProbe);setProbeData(_objectSpread(_objectSpread({},a),{},{type:e.target.value}));setProbeType(newProbe);};// Reset all input data on clicking close button or cancel button\nvar clearData=function clearData(){setProbeData({name:'',type:'httpProbe',mode:'Continuous',runProperties:{},'httpProbe/inputs':{}});setRunProperties({probeTimeout:'',retry:'',interval:'',probePollingInterval:'',initialDelaySeconds:''});setProbeType('httpProbe/inputs');};var handleAddProbe=function handleAddProbe(){var properties=runProperties;if(Number.isNaN(parseInt(properties.initialDelaySeconds,10))){delete properties.initialDelaySeconds;}if(Number.isNaN(parseInt(properties.probePollingInterval,10))){delete properties.probePollingInterval;}allProbes.push(_objectSpread(_objectSpread({},probeData),{},{runProperties:_objectSpread({},properties)}));setAllProbes(allProbes);addProbe(allProbes);};return/*#__PURE__*/React.createElement(Modal,{open:open,onClose:function onClose(){clearData();handleClose();},width:\"60%\",className:classes.modal,\"aria-labelledby\":\"simple-modal-title\",\"aria-describedby\":\"simple-modal-description\",modalActions:/*#__PURE__*/React.createElement(ButtonOutlined,{className:classes.closeButton,onClick:function onClick(){clearData();handleClose();}},\"\\u2715\")},/*#__PURE__*/React.createElement(\"div\",{className:classes.modal},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleAddProbe,className:classes.form},/*#__PURE__*/React.createElement(\"div\",{className:classes.heading},t('createWorkflow.tuneWorkflow.addProbe.heading'),/*#__PURE__*/React.createElement(\"strong\",null,' ',t('createWorkflow.tuneWorkflow.addProbe.headingStrong'))),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"name\",className:classes.formLabel},t('createWorkflow.tuneWorkflow.addProbe.labels.probeName')),/*#__PURE__*/React.createElement(InputField,{id:\"name\",name:\"name\",type:\"text\",required:true,value:probeData.name,helperText:validateProbeName(allProbes,probeData.name)?t('createWorkflow.tuneWorkflow.addProbe.validate'):'',variant:validateProbeName(allProbes,probeData.name)?'error':'primary',onChange:function onChange(e){return setProbeData(_objectSpread(_objectSpread({},probeData),{},{name:e.target.value}));}})),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"type\"},t('createWorkflow.tuneWorkflow.addProbe.labels.probeType')),/*#__PURE__*/React.createElement(Select,{value:probeData.type,className:classes.select,variant:\"outlined\",onChange:onTypeChange,inputProps:{id:'type',name:'type'}},/*#__PURE__*/React.createElement(MenuItem,{value:\"httpProbe\"},t('createWorkflow.tuneWorkflow.addProbe.select.http')),/*#__PURE__*/React.createElement(MenuItem,{value:\"cmdProbe\"},t('createWorkflow.tuneWorkflow.addProbe.select.cmd')),/*#__PURE__*/React.createElement(MenuItem,{value:\"k8sProbe\"},t('createWorkflow.tuneWorkflow.addProbe.select.k8s')),/*#__PURE__*/React.createElement(MenuItem,{value:\"promProbe\"},t('createWorkflow.tuneWorkflow.addProbe.select.prom')))),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"mode\"},t('createWorkflow.tuneWorkflow.addProbe.labels.probeMode')),/*#__PURE__*/React.createElement(Select,{value:probeData.mode,className:classes.select,variant:\"outlined\",onChange:function onChange(e){return setProbeData(_objectSpread(_objectSpread({},probeData),{},{mode:e.target.value}));},inputProps:{id:'mode',name:'mode'}},/*#__PURE__*/React.createElement(MenuItem,{value:\"SOT\"},t('createWorkflow.tuneWorkflow.addProbe.select.sot')),/*#__PURE__*/React.createElement(MenuItem,{value:\"EOT\"},t('createWorkflow.tuneWorkflow.addProbe.select.eot')),/*#__PURE__*/React.createElement(MenuItem,{value:\"Edge\"},t('createWorkflow.tuneWorkflow.addProbe.select.edge')),/*#__PURE__*/React.createElement(MenuItem,{value:\"Continuous\"},t('createWorkflow.tuneWorkflow.addProbe.select.continuous')),/*#__PURE__*/React.createElement(MenuItem,{value:\"OnChaos\"},t('createWorkflow.tuneWorkflow.addProbe.select.onchaos')))),/*#__PURE__*/React.createElement(\"hr\",{className:classes.line}),/*#__PURE__*/React.createElement(\"div\",{className:classes.subHeading},t('createWorkflow.tuneWorkflow.addProbe.labels.probeProp')),/*#__PURE__*/React.createElement(\"div\",{className:classes.detailContainer},/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"timeout\"},t('createWorkflow.tuneWorkflow.addProbe.labels.timeout'),\"(sec)\"),/*#__PURE__*/React.createElement(InputField,{variant:\"primary\",width:\"50%\",id:\"timeout\",name:\"probeTimeout\",required:true,type:\"number\",value:runProperties.probeTimeout,onChange:handleRunProps})),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"retry\"},t('createWorkflow.tuneWorkflow.addProbe.labels.retry'),\"(times)\"),/*#__PURE__*/React.createElement(InputField,{variant:\"primary\",width:\"50%\",id:\"retry\",name:\"retry\",required:true,type:\"number\",value:runProperties.retry,onChange:handleRunProps}))),/*#__PURE__*/React.createElement(\"div\",{className:classes.detailContainer},/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"interval\"},t('createWorkflow.tuneWorkflow.addProbe.labels.interval'),\"(sec)\"),/*#__PURE__*/React.createElement(InputField,{variant:\"primary\",width:\"50%\",id:\"interval\",required:true,name:\"interval\",type:\"number\",value:runProperties.interval,onChange:handleRunProps})),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"polling\"},t('createWorkflow.tuneWorkflow.addProbe.labels.polling'),\"(sec)\"),/*#__PURE__*/React.createElement(InputField,{variant:\"primary\",width:\"50%\",id:\"polling\",name:\"probePollingInterval\",type:\"number\",value:runProperties.probePollingInterval,onChange:handleRunProps}))),/*#__PURE__*/React.createElement(\"div\",{className:classes.formField},/*#__PURE__*/React.createElement(InputLabel,{className:classes.formLabel,htmlFor:\"initial-delay\"},t('createWorkflow.tuneWorkflow.addProbe.labels.initialDelay'),\"(sec)\"),/*#__PURE__*/React.createElement(InputField,{variant:\"primary\",width:\"70%\",id:\"initial-delay\",name:\"initialDelaySeconds\",type:\"number\",value:runProperties.initialDelaySeconds,onChange:handleRunProps})),/*#__PURE__*/React.createElement(\"hr\",{className:classes.line}),/*#__PURE__*/React.createElement(\"div\",{className:classes.subHeading},t('createWorkflow.tuneWorkflow.addProbe.labels.probeDetails')),/*#__PURE__*/React.createElement(ProbeDetails,{setProbeData:setProbeData,probeData:probeData}),/*#__PURE__*/React.createElement(\"div\",{className:classes.buttonDiv},/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:function onClick(){clearData();handleClose();}},t('createWorkflow.tuneWorkflow.addProbe.button.cancel')),/*#__PURE__*/React.createElement(ButtonFilled,{type:\"submit\",disabled:validateProbeName(allProbes,probeData.name)||probeData.name.trim().length===0},t('createWorkflow.tuneWorkflow.addProbe.button.addProbe'))))));};export default AddProbe;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/CreateWorkflow/TuneWorkflow/AddProbe/index.tsx"],"names":["Modal","ButtonOutlined","ButtonFilled","InputField","MenuItem","Select","InputLabel","useTranslation","React","useStyles","ProbeDetails","validateProbeName","AddProbe","probesValue","addProbe","handleClose","open","classes","t","useState","length","allProbes","setAllProbes","probeType","setProbeType","probeTimeout","retry","interval","probePollingInterval","initialDelaySeconds","runProperties","setRunProperties","name","type","mode","probeData","setProbeData","handleRunProps","e","target","parseInt","value","renameKey","object","key","newKey","clonedObj","targetKey","onTypeChange","newProbe","a","clearData","handleAddProbe","properties","Number","isNaN","push","modal","closeButton","form","heading","formField","formLabel","select","id","line","subHeading","detailContainer","buttonDiv","trim"],"mappings":"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","sourcesContent":["import { Modal, ButtonOutlined, ButtonFilled, InputField } from 'litmus-ui';\nimport { MenuItem, Select, InputLabel } from '@material-ui/core';\nimport { useTranslation } from 'react-i18next';\nimport React from 'react';\nimport useStyles from './styles';\nimport ProbeDetails from './ProbeDetails';\nimport { validateProbeName } from '../../../../utils/validate';\n\ninterface AddProbeProps {\n  probesValue: any;\n  addProbe: (probes: any) => void;\n  handleClose: () => void;\n  open: boolean;\n}\n\ninterface RunProperties {\n  probeTimeout: string;\n  retry: string;\n  interval: string;\n  probePollingInterval?: string;\n  initialDelaySeconds?: string;\n}\n\nconst AddProbe: React.FC<AddProbeProps> = ({\n  probesValue,\n  addProbe,\n  handleClose,\n  open,\n}) => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n\n  const [allProbes, setAllProbes] = React.useState(\n    probesValue && probesValue.length ? probesValue : []\n  );\n  const [probeType, setProbeType] = React.useState('httpProbe/inputs');\n  const [runProperties, setRunProperties] = React.useState<RunProperties>({\n    probeTimeout: '',\n    retry: '',\n    interval: '',\n    probePollingInterval: '',\n    initialDelaySeconds: '',\n  });\n  const [probeData, setProbeData] = React.useState({\n    name: '',\n    type: 'httpProbe',\n    mode: 'Continuous',\n    runProperties: {},\n    'httpProbe/inputs': {},\n  });\n  const handleRunProps = (\n    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>\n  ) => {\n    setRunProperties({\n      ...runProperties,\n      [e.target.name]: parseInt(e.target.value, 10),\n    });\n  };\n\n  const renameKey = (object: any, key: string, newKey: string) => {\n    const clonedObj = { ...object };\n    const targetKey = clonedObj[key];\n    delete clonedObj[key];\n    clonedObj[newKey] = targetKey;\n    return clonedObj;\n  };\n\n  const onTypeChange = (\n    e: React.ChangeEvent<{\n      name?: string | undefined;\n      value: unknown;\n    }>\n  ) => {\n    const newProbe = `${e.target.value}/inputs`;\n    const a = renameKey(probeData, probeType, newProbe);\n    setProbeData({\n      ...a,\n      type: e.target.value as string,\n    });\n    setProbeType(newProbe);\n  };\n\n  // Reset all input data on clicking close button or cancel button\n  const clearData = () => {\n    setProbeData({\n      name: '',\n      type: 'httpProbe',\n      mode: 'Continuous',\n      runProperties: {},\n      'httpProbe/inputs': {},\n    });\n    setRunProperties({\n      probeTimeout: '',\n      retry: '',\n      interval: '',\n      probePollingInterval: '',\n      initialDelaySeconds: '',\n    });\n    setProbeType('httpProbe/inputs');\n  };\n\n  const handleAddProbe = () => {\n    const properties = runProperties;\n    if (Number.isNaN(parseInt(properties.initialDelaySeconds as string, 10))) {\n      delete properties.initialDelaySeconds;\n    }\n    if (Number.isNaN(parseInt(properties.probePollingInterval as string, 10))) {\n      delete properties.probePollingInterval;\n    }\n    allProbes.push({\n      ...probeData,\n      runProperties: {\n        ...properties,\n      },\n    });\n    setAllProbes(allProbes);\n    addProbe(allProbes);\n  };\n\n  return (\n    <Modal\n      open={open}\n      onClose={() => {\n        clearData();\n        handleClose();\n      }}\n      width=\"60%\"\n      className={classes.modal}\n      aria-labelledby=\"simple-modal-title\"\n      aria-describedby=\"simple-modal-description\"\n      modalActions={\n        <ButtonOutlined\n          className={classes.closeButton}\n          onClick={() => {\n            clearData();\n            handleClose();\n          }}\n        >\n          &#x2715;\n        </ButtonOutlined>\n      }\n    >\n      <div className={classes.modal}>\n        <form onSubmit={handleAddProbe} className={classes.form}>\n          <div className={classes.heading}>\n            {t('createWorkflow.tuneWorkflow.addProbe.heading')}\n            <strong>\n              {' '}\n              {t('createWorkflow.tuneWorkflow.addProbe.headingStrong')}\n            </strong>\n          </div>\n          <div className={classes.formField}>\n            <InputLabel htmlFor=\"name\" className={classes.formLabel}>\n              {t('createWorkflow.tuneWorkflow.addProbe.labels.probeName')}\n            </InputLabel>\n            <InputField\n              id=\"name\"\n              name=\"name\"\n              type=\"text\"\n              required\n              value={probeData.name}\n              helperText={\n                validateProbeName(allProbes, probeData.name)\n                  ? t('createWorkflow.tuneWorkflow.addProbe.validate')\n                  : ''\n              }\n              variant={\n                validateProbeName(allProbes, probeData.name)\n                  ? 'error'\n                  : 'primary'\n              }\n              onChange={(e) =>\n                setProbeData({ ...probeData, name: e.target.value })\n              }\n            />\n          </div>\n          <div className={classes.formField}>\n            <InputLabel className={classes.formLabel} htmlFor=\"type\">\n              {t('createWorkflow.tuneWorkflow.addProbe.labels.probeType')}\n            </InputLabel>\n            <Select\n              value={probeData.type}\n              className={classes.select}\n              variant=\"outlined\"\n              onChange={onTypeChange}\n              inputProps={{\n                id: 'type',\n                name: 'type',\n              }}\n            >\n              <MenuItem value=\"httpProbe\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.http')}\n              </MenuItem>\n              <MenuItem value=\"cmdProbe\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.cmd')}\n              </MenuItem>\n              <MenuItem value=\"k8sProbe\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.k8s')}\n              </MenuItem>\n              <MenuItem value=\"promProbe\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.prom')}\n              </MenuItem>\n            </Select>\n          </div>\n          <div className={classes.formField}>\n            <InputLabel className={classes.formLabel} htmlFor=\"mode\">\n              {t('createWorkflow.tuneWorkflow.addProbe.labels.probeMode')}\n            </InputLabel>\n            <Select\n              value={probeData.mode}\n              className={classes.select}\n              variant=\"outlined\"\n              onChange={(e) =>\n                setProbeData({\n                  ...probeData,\n                  mode: e.target.value as string,\n                })\n              }\n              inputProps={{\n                id: 'mode',\n                name: 'mode',\n              }}\n            >\n              <MenuItem value=\"SOT\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.sot')}\n              </MenuItem>\n              <MenuItem value=\"EOT\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.eot')}\n              </MenuItem>\n              <MenuItem value=\"Edge\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.edge')}\n              </MenuItem>\n              <MenuItem value=\"Continuous\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.continuous')}\n              </MenuItem>\n              <MenuItem value=\"OnChaos\">\n                {t('createWorkflow.tuneWorkflow.addProbe.select.onchaos')}\n              </MenuItem>\n            </Select>\n          </div>\n          <hr className={classes.line} />\n\n          <div className={classes.subHeading}>\n            {t('createWorkflow.tuneWorkflow.addProbe.labels.probeProp')}\n          </div>\n\n          <div className={classes.detailContainer}>\n            <div className={classes.formField}>\n              <InputLabel className={classes.formLabel} htmlFor=\"timeout\">\n                {t('createWorkflow.tuneWorkflow.addProbe.labels.timeout')}(sec)\n              </InputLabel>\n              <InputField\n                variant=\"primary\"\n                width=\"50%\"\n                id=\"timeout\"\n                name=\"probeTimeout\"\n                required\n                type=\"number\"\n                value={runProperties.probeTimeout}\n                onChange={handleRunProps}\n              />\n            </div>\n            <div className={classes.formField}>\n              <InputLabel className={classes.formLabel} htmlFor=\"retry\">\n                {t('createWorkflow.tuneWorkflow.addProbe.labels.retry')}(times)\n              </InputLabel>\n              <InputField\n                variant=\"primary\"\n                width=\"50%\"\n                id=\"retry\"\n                name=\"retry\"\n                required\n                type=\"number\"\n                value={runProperties.retry}\n                onChange={handleRunProps}\n              />\n            </div>\n          </div>\n          <div className={classes.detailContainer}>\n            <div className={classes.formField}>\n              <InputLabel className={classes.formLabel} htmlFor=\"interval\">\n                {t('createWorkflow.tuneWorkflow.addProbe.labels.interval')}(sec)\n              </InputLabel>\n              <InputField\n                variant=\"primary\"\n                width=\"50%\"\n                id=\"interval\"\n                required\n                name=\"interval\"\n                type=\"number\"\n                value={runProperties.interval}\n                onChange={handleRunProps}\n              />\n            </div>\n            <div className={classes.formField}>\n              <InputLabel className={classes.formLabel} htmlFor=\"polling\">\n                {t('createWorkflow.tuneWorkflow.addProbe.labels.polling')}(sec)\n              </InputLabel>\n              <InputField\n                variant=\"primary\"\n                width=\"50%\"\n                id=\"polling\"\n                name=\"probePollingInterval\"\n                type=\"number\"\n                value={runProperties.probePollingInterval}\n                onChange={handleRunProps}\n              />\n            </div>\n          </div>\n          <div className={classes.formField}>\n            <InputLabel className={classes.formLabel} htmlFor=\"initial-delay\">\n              {t('createWorkflow.tuneWorkflow.addProbe.labels.initialDelay')}\n              (sec)\n            </InputLabel>\n            <InputField\n              variant=\"primary\"\n              width=\"70%\"\n              id=\"initial-delay\"\n              name=\"initialDelaySeconds\"\n              type=\"number\"\n              value={runProperties.initialDelaySeconds}\n              onChange={handleRunProps}\n            />\n          </div>\n          <hr className={classes.line} />\n          <div className={classes.subHeading}>\n            {t('createWorkflow.tuneWorkflow.addProbe.labels.probeDetails')}\n          </div>\n\n          <ProbeDetails setProbeData={setProbeData} probeData={probeData} />\n\n          <div className={classes.buttonDiv}>\n            <ButtonOutlined\n              onClick={() => {\n                clearData();\n                handleClose();\n              }}\n            >\n              {t('createWorkflow.tuneWorkflow.addProbe.button.cancel')}\n            </ButtonOutlined>\n            <ButtonFilled\n              type=\"submit\"\n              disabled={\n                validateProbeName(allProbes, probeData.name) ||\n                probeData.name.trim().length === 0\n              }\n            >\n              {t('createWorkflow.tuneWorkflow.addProbe.button.addProbe')}\n            </ButtonFilled>\n          </div>\n        </form>\n      </div>\n    </Modal>\n  );\n};\n\nexport default AddProbe;\n"]},"metadata":{},"sourceType":"module"}