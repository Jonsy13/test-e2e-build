{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Accordion,AccordionSummary,RadioGroup,Typography}from'@material-ui/core';import{RadioButton}from'litmus-ui';import localforage from'localforage';import React,{forwardRef,useEffect,useImperativeHandle,useState}from'react';import{useTranslation}from'react-i18next';import{useSelector}from'react-redux';import useActions from'../../../redux/actions';import*as AlertActions from'../../../redux/actions/alert';import*as WorkflowActions from'../../../redux/actions/workflow';import ChoosePreDefinedExperiments from'./choosePreDefinedExperiments';import ChooseWorkflowFromExisting from'./ChooseWorkflowFromExisting';import SelectMyHub from'./SelectMyHub';import useStyles from'./styles';import UploadYAML from'./uploadYAML';var ChooseWorkflow=forwardRef(function(_,ref){var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var alert=useActions(AlertActions);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),selected=_useState2[0],setSelected=_useState2[1];var workflowDetails=useSelector(function(state){return state.workflowManifest.manifest;});var workflowAction=useActions(WorkflowActions);var handleChange=function handleChange(event){setSelected(event.target.value);localforage.setItem('selectedScheduleOption',{selected:event.target.value});if(event.target.value==='C'||event.target.value==='D'){workflowAction.setWorkflowManifest({isCustomWorkflow:true});}else{workflowAction.setWorkflowManifest({isCustomWorkflow:false});}};function onNext(){if(selected===''){alert.changeAlertState(true);// No Workflow Type has been selected and user clicked on Next\nreturn false;}if(selected==='D'&&workflowDetails===''){alert.changeAlertState(true);return false;}alert.changeAlertState(false);return true;}useEffect(function(){localforage.getItem('selectedScheduleOption').then(function(value){if(value){setSelected(value.selected);}else setSelected('');});workflowAction.setWorkflowManifest({manifest:''});/**\n     * Removes the workflow details if already present\n     */localforage.removeItem('workflow');},[]);useImperativeHandle(ref,function(){return{onNext:onNext};});return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(\"div\",{className:classes.innerContainer},/*#__PURE__*/React.createElement(\"div\",{\"aria-label\":\"header\",className:classes.header},/*#__PURE__*/React.createElement(\"div\",{\"aria-label\":\"headerLeft\"},/*#__PURE__*/React.createElement(Typography,{className:classes.title},t('createWorkflow.chooseWorkflow.title')),/*#__PURE__*/React.createElement(Typography,{className:classes.subtitle},t('createWorkflow.chooseWorkflow.subtitle')))),/*#__PURE__*/React.createElement(\"hr\",{className:classes.divider}),/*#__PURE__*/React.createElement(\"div\",{className:classes.m5}),/*#__PURE__*/React.createElement(RadioGroup,{\"data-testid\":\"workflowRadioButtons\",\"data-cy\":\"WorkflowsRadioGroup\",value:selected,onChange:handleChange},/*#__PURE__*/React.createElement(Accordion,{expanded:selected==='A',className:classes.accordion},/*#__PURE__*/React.createElement(AccordionSummary,null,/*#__PURE__*/React.createElement(RadioButton,{value:\"A\",\"data-cy\":\"PredefinedWorkflowsRadioButton\",onChange:function onChange(e){return handleChange(e);}},/*#__PURE__*/React.createElement(\"span\",{\"data-testid\":\"option\"},t('createWorkflow.chooseWorkflow.optionA')))),/*#__PURE__*/React.createElement(ChoosePreDefinedExperiments,null)),/*#__PURE__*/React.createElement(Accordion,{expanded:selected==='B',classes:{root:classes.MuiAccordionroot},className:classes.accordion},/*#__PURE__*/React.createElement(AccordionSummary,null,/*#__PURE__*/React.createElement(RadioButton,{value:\"B\",\"data-cy\":\"templateWorkflowsRadioButton\",onChange:function onChange(e){return handleChange(e);}},/*#__PURE__*/React.createElement(\"span\",{\"data-testid\":\"option\"},t('createWorkflow.chooseWorkflow.optionB')))),/*#__PURE__*/React.createElement(ChooseWorkflowFromExisting,null)),/*#__PURE__*/React.createElement(Accordion,{expanded:selected==='C',classes:{root:classes.MuiAccordionroot},className:classes.accordion},/*#__PURE__*/React.createElement(AccordionSummary,null,/*#__PURE__*/React.createElement(RadioButton,{value:\"C\",\"data-cy\":\"myHubsRadioButton\",onChange:function onChange(e){return handleChange(e);}},/*#__PURE__*/React.createElement(\"span\",{\"data-testid\":\"option\"},t('createWorkflow.chooseWorkflow.optionC')),' ',/*#__PURE__*/React.createElement(\"span\",{className:classes.bold},t('createWorkflow.chooseWorkflow.myHubs')))),/*#__PURE__*/React.createElement(SelectMyHub,null)),/*#__PURE__*/React.createElement(Accordion,{expanded:selected==='D',classes:{root:classes.MuiAccordionroot},className:classes.accordion},/*#__PURE__*/React.createElement(AccordionSummary,null,/*#__PURE__*/React.createElement(RadioButton,{value:\"D\",\"data-cy\":\"uploadYAMLRadioButton\",onChange:function onChange(e){return handleChange(e);}},/*#__PURE__*/React.createElement(\"span\",{\"data-testid\":\"option\"},t('createWorkflow.chooseWorkflow.optionD')))),/*#__PURE__*/React.createElement(UploadYAML,null)))));});export default ChooseWorkflow;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/CreateWorkflow/ChooseWorkflow/index.tsx"],"names":["Accordion","AccordionSummary","RadioGroup","Typography","RadioButton","localforage","React","forwardRef","useEffect","useImperativeHandle","useState","useTranslation","useSelector","useActions","AlertActions","WorkflowActions","ChoosePreDefinedExperiments","ChooseWorkflowFromExisting","SelectMyHub","useStyles","UploadYAML","ChooseWorkflow","_","ref","classes","t","alert","selected","setSelected","workflowDetails","state","workflowManifest","manifest","workflowAction","handleChange","event","target","value","setItem","setWorkflowManifest","isCustomWorkflow","onNext","changeAlertState","getItem","then","removeItem","root","innerContainer","header","title","subtitle","divider","m5","accordion","e","MuiAccordionroot","bold"],"mappings":"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","sourcesContent":["import {\n  Accordion,\n  AccordionSummary,\n  RadioGroup,\n  Typography,\n} from '@material-ui/core';\nimport { RadioButton } from 'litmus-ui';\nimport localforage from 'localforage';\nimport React, {\n  forwardRef,\n  useEffect,\n  useImperativeHandle,\n  useState,\n} from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useSelector } from 'react-redux';\nimport { ChooseWorkflowRadio } from '../../../models/localforage/radioButton';\nimport useActions from '../../../redux/actions';\nimport * as AlertActions from '../../../redux/actions/alert';\nimport * as WorkflowActions from '../../../redux/actions/workflow';\nimport { RootState } from '../../../redux/reducers';\nimport ChoosePreDefinedExperiments from './choosePreDefinedExperiments';\nimport ChooseWorkflowFromExisting from './ChooseWorkflowFromExisting';\nimport SelectMyHub from './SelectMyHub';\nimport useStyles from './styles';\nimport UploadYAML from './uploadYAML';\n\nconst ChooseWorkflow = forwardRef((_, ref) => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const alert = useActions(AlertActions);\n  const [selected, setSelected] = useState<string>('');\n  const workflowDetails = useSelector(\n    (state: RootState) => state.workflowManifest.manifest\n  );\n  const workflowAction = useActions(WorkflowActions);\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setSelected(event.target.value);\n    localforage.setItem('selectedScheduleOption', {\n      selected: event.target.value,\n    });\n    if (event.target.value === 'C' || event.target.value === 'D') {\n      workflowAction.setWorkflowManifest({\n        isCustomWorkflow: true,\n      });\n    } else {\n      workflowAction.setWorkflowManifest({\n        isCustomWorkflow: false,\n      });\n    }\n  };\n\n  function onNext() {\n    if (selected === '') {\n      alert.changeAlertState(true); // No Workflow Type has been selected and user clicked on Next\n      return false;\n    }\n    if (selected === 'D' && workflowDetails === '') {\n      alert.changeAlertState(true);\n      return false;\n    }\n    alert.changeAlertState(false);\n    return true;\n  }\n\n  useEffect(() => {\n    localforage.getItem('selectedScheduleOption').then((value) => {\n      if (value) {\n        setSelected((value as ChooseWorkflowRadio).selected);\n      } else setSelected('');\n    });\n    workflowAction.setWorkflowManifest({\n      manifest: '',\n    });\n    /**\n     * Removes the workflow details if already present\n     */\n    localforage.removeItem('workflow');\n  }, []);\n\n  useImperativeHandle(ref, () => ({\n    onNext,\n  }));\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.innerContainer}>\n        {/* Header */}\n        <div aria-label=\"header\" className={classes.header}>\n          <div aria-label=\"headerLeft\">\n            <Typography className={classes.title}>\n              {t('createWorkflow.chooseWorkflow.title')}\n            </Typography>\n            <Typography className={classes.subtitle}>\n              {t('createWorkflow.chooseWorkflow.subtitle')}\n            </Typography>\n          </div>\n        </div>\n\n        <hr className={classes.divider} />\n\n        {/* Selection Radio Buttons */}\n        <div className={classes.m5} />\n\n        <RadioGroup\n          data-testid=\"workflowRadioButtons\"\n          data-cy=\"WorkflowsRadioGroup\"\n          value={selected}\n          onChange={handleChange}\n        >\n          <Accordion expanded={selected === 'A'} className={classes.accordion}>\n            <AccordionSummary>\n              <RadioButton\n                value=\"A\"\n                data-cy=\"PredefinedWorkflowsRadioButton\"\n                onChange={(e) => handleChange(e)}\n              >\n                <span data-testid=\"option\">\n                  {t('createWorkflow.chooseWorkflow.optionA')}\n                </span>\n              </RadioButton>\n            </AccordionSummary>\n            <ChoosePreDefinedExperiments />\n          </Accordion>\n\n          <Accordion\n            expanded={selected === 'B'}\n            classes={{\n              root: classes.MuiAccordionroot,\n            }}\n            className={classes.accordion}\n          >\n            <AccordionSummary>\n              <RadioButton\n                value=\"B\"\n                data-cy=\"templateWorkflowsRadioButton\"\n                onChange={(e) => handleChange(e)}\n              >\n                <span data-testid=\"option\">\n                  {t('createWorkflow.chooseWorkflow.optionB')}\n                </span>\n              </RadioButton>\n            </AccordionSummary>\n            <ChooseWorkflowFromExisting />\n          </Accordion>\n\n          <Accordion\n            expanded={selected === 'C'}\n            classes={{\n              root: classes.MuiAccordionroot,\n            }}\n            className={classes.accordion}\n          >\n            <AccordionSummary>\n              <RadioButton\n                value=\"C\"\n                data-cy=\"myHubsRadioButton\"\n                onChange={(e) => handleChange(e)}\n              >\n                <span data-testid=\"option\">\n                  {t('createWorkflow.chooseWorkflow.optionC')}\n                </span>{' '}\n                <span className={classes.bold}>\n                  {t('createWorkflow.chooseWorkflow.myHubs')}\n                </span>\n              </RadioButton>\n            </AccordionSummary>\n            <SelectMyHub />\n          </Accordion>\n\n          <Accordion\n            expanded={selected === 'D'}\n            classes={{\n              root: classes.MuiAccordionroot,\n            }}\n            className={classes.accordion}\n          >\n            <AccordionSummary>\n              <RadioButton\n                value=\"D\"\n                data-cy=\"uploadYAMLRadioButton\"\n                onChange={(e) => handleChange(e)}\n              >\n                <span data-testid=\"option\">\n                  {t('createWorkflow.chooseWorkflow.optionD')}\n                </span>\n              </RadioButton>\n            </AccordionSummary>\n            <UploadYAML />\n          </Accordion>\n        </RadioGroup>\n      </div>\n    </div>\n  );\n});\n\nexport default ChooseWorkflow;\n"]},"metadata":{},"sourceType":"module"}