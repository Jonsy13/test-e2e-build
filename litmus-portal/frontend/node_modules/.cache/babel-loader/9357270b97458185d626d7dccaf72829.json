{"ast":null,"code":"import _slicedToArray from\"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Typography}from'@material-ui/core';import{ButtonFilled,ButtonOutlined,Modal}from'litmus-ui';import React from'react';import{useTranslation}from'react-i18next';import Loader from'../../../../../components/Loader';import config from'../../../../../config';import{getToken}from'../../../../../utils/auth';import useStyles from'./styles';// props for ResetModal component\n// ResetModal displays modal for resetting the password\nvar ResetModal=function ResetModal(_ref){var resetPossible=_ref.resetPossible,username=_ref.username,new_password=_ref.new_password,handleModal=_ref.handleModal;var classes=useStyles();var _useTranslation=useTranslation(),t=_useTranslation.t;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),loading=_React$useState4[0],setLoading=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),error=_React$useState6[0],setError=_React$useState6[1];var handleClose=function handleClose(){setOpen(false);};var handleClick=function handleClick(){setLoading(true);fetch(\"\".concat(config.auth.url,\"/reset/password\"),{method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(getToken())},body:JSON.stringify({username:username,new_password:new_password})}).then(function(response){return response.json();}).then(function(data){if('error'in data){setError(data.error_description);}else{setError('');}setLoading(false);setOpen(true);}).catch(function(err){console.error(err);setError(err.message);if(resetPossible){setLoading(false);setOpen(true);}});};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{\"data-cy\":\"edit\"},/*#__PURE__*/React.createElement(ButtonFilled,{variant:\"success\",disabled:!(new_password.length&&!loading),onClick:handleClick},loading?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Loader,{size:20})):/*#__PURE__*/React.createElement(React.Fragment,null,t('settings.userManagementTab.editUser.resetModal.button.save')))),/*#__PURE__*/React.createElement(Modal,{open:open,onClose:handleClose,modalActions:/*#__PURE__*/React.createElement(ButtonOutlined,{onClick:handleClose},\"\\u2715\")},error.length?/*#__PURE__*/React.createElement(\"div\",{className:classes.errDiv},/*#__PURE__*/React.createElement(\"div\",{className:classes.textError},/*#__PURE__*/React.createElement(Typography,{className:classes.typo,align:\"center\"},/*#__PURE__*/React.createElement(\"strong\",null,t('settings.userManagementTab.editUser.resetModal.error')),' ',t('settings.userManagementTab.editUser.resetModal.headerErr'))),/*#__PURE__*/React.createElement(\"div\",{className:classes.textSecondError},/*#__PURE__*/React.createElement(Typography,{className:classes.typoSub},t('settings.userManagementTab.editUser.resetModal.error'),\":\",' ',error)),/*#__PURE__*/React.createElement(\"div\",{\"data-cy\":\"done\",className:classes.buttonModal},/*#__PURE__*/React.createElement(ButtonFilled,{disabled:false,onClick:handleClose},/*#__PURE__*/React.createElement(React.Fragment,null,t('settings.userManagementTab.editUser.resetModal.button.done'))))):/*#__PURE__*/React.createElement(\"div\",{className:classes.body},/*#__PURE__*/React.createElement(\"img\",{src:\"./icons/checkmark.svg\",alt:\"checkmark\"}),/*#__PURE__*/React.createElement(\"div\",{className:classes.textSucess},/*#__PURE__*/React.createElement(Typography,{className:classes.typo,align:\"center\"},t('settings.userManagementTab.editUser.resetModal.header'),' ',/*#__PURE__*/React.createElement(\"strong\",null,t('settings.userManagementTab.editUser.resetModal.headerStrong')))),/*#__PURE__*/React.createElement(\"div\",{className:classes.text1Sucess},/*#__PURE__*/React.createElement(Typography,{className:classes.typoSub,align:\"center\"},t('settings.userManagementTab.editUser.resetModal.info'))),/*#__PURE__*/React.createElement(\"div\",{\"data-cy\":\"done\"},/*#__PURE__*/React.createElement(ButtonFilled,{disabled:false,onClick:handleModal},t('settings.userManagementTab.editUser.resetModal.button.done'))))));};export default ResetModal;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Settings/UserManagementTab/EditUser/ResetModal/index.tsx"],"names":["Typography","ButtonFilled","ButtonOutlined","Modal","React","useTranslation","Loader","config","getToken","useStyles","ResetModal","resetPossible","username","new_password","handleModal","classes","t","useState","open","setOpen","loading","setLoading","error","setError","handleClose","handleClick","fetch","auth","url","method","headers","Authorization","body","JSON","stringify","then","response","json","data","error_description","catch","err","console","message","length","errDiv","textError","typo","textSecondError","typoSub","buttonModal","textSucess","text1Sucess"],"mappings":"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","sourcesContent":["import { Typography } from '@material-ui/core';\nimport { ButtonFilled, ButtonOutlined, Modal } from 'litmus-ui';\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport Loader from '../../../../../components/Loader';\nimport config from '../../../../../config';\nimport { getToken } from '../../../../../utils/auth';\nimport useStyles from './styles';\n\n// props for ResetModal component\ninterface ResetModalProps {\n  resetPossible: boolean;\n  new_password: string;\n  username: string;\n  handleModal: () => void;\n}\n\n// ResetModal displays modal for resetting the password\nconst ResetModal: React.FC<ResetModalProps> = ({\n  resetPossible,\n  username,\n  new_password,\n  handleModal,\n}) => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n\n  const [open, setOpen] = React.useState(false);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<string>('');\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleClick = () => {\n    setLoading(true);\n    fetch(`${config.auth.url}/reset/password`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getToken()}`,\n      },\n      body: JSON.stringify({ username, new_password }),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        if ('error' in data) {\n          setError(data.error_description as string);\n        } else {\n          setError('');\n        }\n        setLoading(false);\n        setOpen(true);\n      })\n      .catch((err) => {\n        console.error(err);\n        setError(err.message as string);\n        if (resetPossible) {\n          setLoading(false);\n          setOpen(true);\n        }\n      });\n  };\n\n  return (\n    <div>\n      <div data-cy=\"edit\">\n        <ButtonFilled\n          variant=\"success\"\n          disabled={!(new_password.length && !loading)}\n          onClick={handleClick}\n        >\n          {loading ? (\n            <div>\n              <Loader size={20} />\n            </div>\n          ) : (\n            <>\n              {t('settings.userManagementTab.editUser.resetModal.button.save')}\n            </>\n          )}\n        </ButtonFilled>\n      </div>\n      <Modal\n        open={open}\n        onClose={handleClose}\n        modalActions={\n          <ButtonOutlined onClick={handleClose}>&#x2715;</ButtonOutlined>\n        }\n      >\n        {error.length ? (\n          <div className={classes.errDiv}>\n            <div className={classes.textError}>\n              <Typography className={classes.typo} align=\"center\">\n                <strong>\n                  {t('settings.userManagementTab.editUser.resetModal.error')}\n                </strong>{' '}\n                {t('settings.userManagementTab.editUser.resetModal.headerErr')}\n              </Typography>\n            </div>\n            <div className={classes.textSecondError}>\n              <Typography className={classes.typoSub}>\n                {t('settings.userManagementTab.editUser.resetModal.error')}:{' '}\n                {error}\n              </Typography>\n            </div>\n            <div data-cy=\"done\" className={classes.buttonModal}>\n              <ButtonFilled disabled={false} onClick={handleClose}>\n                <>\n                  {t(\n                    'settings.userManagementTab.editUser.resetModal.button.done'\n                  )}\n                </>\n              </ButtonFilled>\n            </div>\n          </div>\n        ) : (\n          <div className={classes.body}>\n            <img src=\"./icons/checkmark.svg\" alt=\"checkmark\" />\n            <div className={classes.textSucess}>\n              <Typography className={classes.typo} align=\"center\">\n                {t('settings.userManagementTab.editUser.resetModal.header')}{' '}\n                <strong>\n                  {t(\n                    'settings.userManagementTab.editUser.resetModal.headerStrong'\n                  )}\n                </strong>\n              </Typography>\n            </div>\n            <div className={classes.text1Sucess}>\n              <Typography className={classes.typoSub} align=\"center\">\n                {t('settings.userManagementTab.editUser.resetModal.info')}\n              </Typography>\n            </div>\n            <div data-cy=\"done\">\n              <ButtonFilled disabled={false} onClick={handleModal}>\n                {t(\n                  'settings.userManagementTab.editUser.resetModal.button.done'\n                )}\n              </ButtonFilled>\n            </div>\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n};\nexport default ResetModal;\n"]},"metadata":{},"sourceType":"module"}