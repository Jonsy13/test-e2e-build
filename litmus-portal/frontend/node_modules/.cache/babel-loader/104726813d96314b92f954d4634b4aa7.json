{"ast":null,"code":"import _slicedToArray from \"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Settings/TeamingTab/Invitation/AcceptedInvitations/index.tsx\";\n\nimport { useMutation, useQuery } from '@apollo/client';\nimport { IconButton, Paper, Typography } from '@material-ui/core';\nimport { ButtonFilled } from 'litmus-ui';\nimport React, { useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { GET_PROJECT, LEAVE_PROJECT, LIST_PROJECTS } from '../../../../../graphql';\nimport { history } from '../../../../../redux/configureStore';\nimport { getUserId } from '../../../../../utils/auth';\nimport { getProjectID } from '../../../../../utils/getSearchParams';\nimport useStyles from './styles';\n\nvar AcceptedInvitations = function AcceptedInvitations() {\n  var classes = useStyles();\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var userID = getUserId();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      projectOther = _useState2[0],\n      setProjectOther = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      projects = _useState4[0],\n      setProjects = _useState4[1];\n\n  var _useQuery = useQuery(LIST_PROJECTS, {\n    onCompleted: function onCompleted() {\n      if (dataProject === null || dataProject === void 0 ? void 0 : dataProject.listProjects) {\n        setProjects(dataProject === null || dataProject === void 0 ? void 0 : dataProject.listProjects);\n      }\n    }\n  }),\n      dataProject = _useQuery.data; // const userData = useSelector((state: RootState) => state.userData);\n\n\n  var projectID = getProjectID(); // stores the user who has left the project\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      exitedMember = _useState6[0],\n      setExitedMember = _useState6[1];\n\n  var _useMutation = useMutation(LEAVE_PROJECT, {\n    onCompleted: function onCompleted() {\n      setProjectOther(projectOther.filter(function (row) {\n        return row.projectDetails.id !== exitedMember;\n      }));\n    },\n    refetchQueries: [{\n      query: GET_PROJECT,\n      variables: {\n        projectID: projectID\n      }\n    }, {\n      query: LIST_PROJECTS\n    }]\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      leaveProject = _useMutation2[0];\n\n  useEffect(function () {\n    var otherProject = [];\n    projects.map(function (project) {\n      return project.members.forEach(function (member) {\n        if (member.user_id === userID && member.role !== 'Owner' && member.invitation === 'Accepted') {\n          otherProject.push({\n            projectDetails: project,\n            currentUserProjectRole: member.role\n          });\n        }\n      });\n    });\n    setProjectOther([].concat(otherProject));\n  }, [projects]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, projectOther.length ? projectOther.map(function (project) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      \"data-cy\": \"receivedInvitationModal\",\n      className: classes.rootDiv,\n      key: \"\".concat(project),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Paper, {\n      className: classes.root,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.projectDiv,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      className: classes.projectName,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }\n    }, project.projectDetails.name), /*#__PURE__*/React.createElement(IconButton, {\n      className: classes.viewProject,\n      onClick: function onClick() {\n        history.push({\n          pathname: \"/home\",\n          search: \"?projectID=\".concat(project.projectDetails.id, \"&projectRole=\").concat(project.currentUserProjectRole)\n        });\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 19\n      }\n    }, t('settings.teamingTab.invitation.acceptedInvitation.viewProject')))), /*#__PURE__*/React.createElement(Typography, {\n      className: classes.projectRole,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 15\n      }\n    }, t('settings.teamingTab.invitation.acceptedInvitation.role'), \":\", ' ', project.currentUserProjectRole), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.buttonDiv,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      \"data-cy\": \"LeaveProject\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(ButtonFilled, {\n      className: classes.leaveProjectBtn,\n      onClick: function onClick() {\n        setExitedMember(project.projectDetails.id);\n        leaveProject({\n          variables: {\n            data: {\n              project_id: project.projectDetails.id,\n              user_id: getUserId(),\n              role: project.currentUserProjectRole\n            }\n          }\n        });\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 19\n      }\n    }, t('settings.teamingTab.invitation.receivedInvitation.button.leave'))))));\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null));\n};\n\nexport default AcceptedInvitations;","map":{"version":3,"sources":["/home/vedant/go/src/github.com/litmus/litmus-portal/frontend/src/views/Settings/TeamingTab/Invitation/AcceptedInvitations/index.tsx"],"names":["useMutation","useQuery","IconButton","Paper","Typography","ButtonFilled","React","useEffect","useState","useTranslation","GET_PROJECT","LEAVE_PROJECT","LIST_PROJECTS","history","getUserId","getProjectID","useStyles","AcceptedInvitations","classes","t","userID","projectOther","setProjectOther","projects","setProjects","onCompleted","dataProject","listProjects","data","projectID","exitedMember","setExitedMember","filter","row","projectDetails","id","refetchQueries","query","variables","leaveProject","otherProject","map","project","members","forEach","member","user_id","role","invitation","push","currentUserProjectRole","length","rootDiv","root","projectDiv","projectName","name","viewProject","pathname","search","projectRole","buttonDiv","leaveProjectBtn","project_id"],"mappings":"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","sourcesContent":["import { useMutation, useQuery } from '@apollo/client';\nimport { IconButton, Paper, Typography } from '@material-ui/core';\nimport { ButtonFilled } from 'litmus-ui';\nimport React, { useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  GET_PROJECT,\n  LEAVE_PROJECT,\n  LIST_PROJECTS,\n} from '../../../../../graphql';\nimport { MemberInvitation } from '../../../../../models/graphql/invite';\nimport { Member, Project, Projects } from '../../../../../models/graphql/user';\nimport { history } from '../../../../../redux/configureStore';\nimport { getUserId } from '../../../../../utils/auth';\nimport { getProjectID } from '../../../../../utils/getSearchParams';\nimport useStyles from './styles';\n\ninterface OtherProjectsType {\n  projectDetails: Project;\n  currentUserProjectRole: string;\n}\n\nconst AcceptedInvitations: React.FC = () => {\n  const classes = useStyles();\n  const { t } = useTranslation();\n\n  const userID = getUserId();\n  const [projectOther, setProjectOther] = useState<OtherProjectsType[]>([]);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const { data: dataProject } = useQuery<Projects>(LIST_PROJECTS, {\n    onCompleted: () => {\n      if (dataProject?.listProjects) {\n        setProjects(dataProject?.listProjects);\n      }\n    },\n  });\n  // const userData = useSelector((state: RootState) => state.userData);\n  const projectID = getProjectID();\n\n  // stores the user who has left the project\n  const [exitedMember, setExitedMember] = useState<string>('');\n\n  const [leaveProject] = useMutation<MemberInvitation>(LEAVE_PROJECT, {\n    onCompleted: () => {\n      setProjectOther(\n        projectOther.filter((row) => row.projectDetails.id !== exitedMember)\n      );\n    },\n    refetchQueries: [\n      {\n        query: GET_PROJECT,\n        variables: { projectID },\n      },\n      { query: LIST_PROJECTS },\n    ],\n  });\n\n  useEffect(() => {\n    const otherProject: OtherProjectsType[] = [];\n    projects.map((project) => {\n      return project.members.forEach((member: Member) => {\n        if (\n          member.user_id === userID &&\n          member.role !== 'Owner' &&\n          member.invitation === 'Accepted'\n        ) {\n          otherProject.push({\n            projectDetails: project,\n            currentUserProjectRole: member.role,\n          });\n        }\n      });\n    });\n    setProjectOther([...otherProject]);\n  }, [projects]);\n\n  return (\n    <>\n      {projectOther.length ? (\n        projectOther.map((project) => (\n          <div\n            data-cy=\"receivedInvitationModal\"\n            className={classes.rootDiv}\n            key={`${project}`}\n          >\n            <Paper className={classes.root}>\n              <div className={classes.projectDiv}>\n                <Typography className={classes.projectName}>\n                  {project.projectDetails.name}\n                </Typography>\n                <IconButton\n                  className={classes.viewProject}\n                  onClick={() => {\n                    history.push({\n                      pathname: `/home`,\n                      search: `?projectID=${project.projectDetails.id}&projectRole=${project.currentUserProjectRole}`,\n                    });\n                  }}\n                >\n                  <Typography>\n                    {t(\n                      'settings.teamingTab.invitation.acceptedInvitation.viewProject'\n                    )}\n                  </Typography>\n                </IconButton>\n              </div>\n              <Typography className={classes.projectRole}>\n                {t('settings.teamingTab.invitation.acceptedInvitation.role')}:{' '}\n                {project.currentUserProjectRole}\n              </Typography>\n              <div className={classes.buttonDiv}>\n                <div data-cy=\"LeaveProject\">\n                  <ButtonFilled\n                    className={classes.leaveProjectBtn}\n                    onClick={() => {\n                      setExitedMember(project.projectDetails.id);\n                      leaveProject({\n                        variables: {\n                          data: {\n                            project_id: project.projectDetails.id,\n                            user_id: getUserId(),\n                            role: project.currentUserProjectRole,\n                          },\n                        },\n                      });\n                    }}\n                  >\n                    {t(\n                      'settings.teamingTab.invitation.receivedInvitation.button.leave'\n                    )}\n                  </ButtonFilled>\n                </div>\n              </div>\n            </Paper>\n          </div>\n        ))\n      ) : (\n        <></>\n      )}\n    </>\n  );\n};\n\nexport default AcceptedInvitations;\n"]},"metadata":{},"sourceType":"module"}